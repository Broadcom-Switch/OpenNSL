<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenNSL API Guide and Reference Manual: examples/example_bst.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&nbsp;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>examples/example_bst.c</h1><a href="example__bst_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2016</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * \file         example_bst.c</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * \brief        OpenNSL example program for showing statistics</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * \details      OpenNSL example program for displaying and clearing BST</span>
<a name="l00024"></a>00024 <span class="comment"> *               statistics of a given interface.</span>
<a name="l00025"></a>00025 <span class="comment"> *</span>
<a name="l00026"></a>00026 <span class="comment"> **********************************************************************/</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="cosq_8h.html">opennsl/cosq.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2switch_8h.html">opennsl/switch.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="example__bst_8c.html#a91668ed1245d073a2ac84e6121205d28">00038</a> <span class="preprocessor">#define DEFAULT_VLAN 1</span>
<a name="l00039"></a><a class="code" href="example__bst_8c.html#ae561a2dab8025f585c77571f67d4771e">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_COUNTERS 4</span>
<a name="l00040"></a><a class="code" href="example__bst_8c.html#a20c3efb1df0911d9071bd4f9bf129acc">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_COSQ_COUNT 8</span>
<a name="l00041"></a><a class="code" href="example__bst_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_UNIT 0</span>
<a name="l00042"></a><a class="code" href="example__bst_8c.html#a068278b0838b6670ab0ab0a93ed77484">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_DIGITS_IN_CHOICE 5</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="example__bst_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">00044</a> <span class="keywordtype">char</span> <a class="code" href="example__bst_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =
<a name="l00045"></a>00045 <span class="stringliteral">&quot;Syntax: example_bst                                                   \n\r&quot;</span>
<a name="l00046"></a>00046 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00047"></a>00047 <span class="stringliteral">&quot;Paramaters: None                                                      \n\r&quot;</span>
<a name="l00048"></a>00048 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00049"></a>00049 <span class="stringliteral">&quot;Example: The following command is used to see the bst stats of a port \n\r&quot;</span>
<a name="l00050"></a>00050 <span class="stringliteral">&quot;         example_bst                                                  \n\r&quot;</span>
<a name="l00051"></a>00051 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00052"></a>00052 <span class="stringliteral">&quot;Usage Guidelines: This program request the user to enter the port     \n\r&quot;</span>
<a name="l00053"></a>00053 <span class="stringliteral">&quot;                  number interactively                                \n\r&quot;</span>;
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="structexample__bst__counter__t.html">00055</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00056"></a><a class="code" href="structexample__bst__counter__t.html#ab0d7d61d949076d1ded723ecedf58e72">00056</a>   <a class="code" href="group__cosq.html#ga24cdfbab33b9fe855b3887ae58ee05b8" title="BST Tracing statistics resources type eumerations.">opennsl_bst_stat_id_t</a> bid;
<a name="l00057"></a><a class="code" href="structexample__bst__counter__t.html#af82e6dc4d77a60c363a248a494753608">00057</a>   <span class="keywordtype">char</span> name[50];
<a name="l00058"></a>00058 } <a class="code" href="structexample__bst__counter__t.html">example_bst_counter_t</a>;
<a name="l00059"></a>00059 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="example__bst_8c.html#ad934a73a140f9a96329a91b4ff75d25a">00062</a> <span class="preprocessor">#define _BST_STAT_ID_DEVICE                    opennslBstStatIdDevice</span>
<a name="l00063"></a><a class="code" href="example__bst_8c.html#af9fa8ed3df54173135be7fb6ab9c92d4">00063</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_EGR_POOL                  opennslBstStatIdEgrPool</span>
<a name="l00064"></a><a class="code" href="example__bst_8c.html#a6ac92692b0115a6357ed91ef3b6de831">00064</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_EGR_MCAST_POOL            opennslBstStatIdEgrMCastPool</span>
<a name="l00065"></a><a class="code" href="example__bst_8c.html#a0a7fea14479b16553be4a990b27d9e45">00065</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_ING_POOL                  opennslBstStatIdIngPool</span>
<a name="l00066"></a><a class="code" href="example__bst_8c.html#afbe8df21008aed42d2d55119d3f51681">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_PORT_POOL                 opennslBstStatIdPortPool</span>
<a name="l00067"></a><a class="code" href="example__bst_8c.html#af63bf10310a35680b08a5200de43ea28">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_PRI_GROUP_SHARED          opennslBstStatIdPriGroupShared</span>
<a name="l00068"></a><a class="code" href="example__bst_8c.html#aa9658a6f23dff63eb7adab39840529bb">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_PRI_GROUP_HEADROOM        opennslBstStatIdPriGroupHeadroom</span>
<a name="l00069"></a><a class="code" href="example__bst_8c.html#a0dae4c3cdcb1e3ddbd80fab28ca7962b">00069</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_UCAST                     opennslBstStatIdUcast</span>
<a name="l00070"></a><a class="code" href="example__bst_8c.html#a26f3850fc17989dac9e0a5d4c418f7ca">00070</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_MCAST                     opennslBstStatIdMcast</span>
<a name="l00071"></a><a class="code" href="example__bst_8c.html#a7a5f9d9d2821ba06269f87a64ee28d10">00071</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_EGR_UCAST_PORT_SHARED     opennslBstStatIdEgrUCastPortShared</span>
<a name="l00072"></a><a class="code" href="example__bst_8c.html#a9b7c22df5edbbab51e096438f2a3fda7">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_EGR_PORT_SHARED           opennslBstStatIdEgrPortShared</span>
<a name="l00073"></a><a class="code" href="example__bst_8c.html#af23204c398f6c8e8290b2d5fa112c856">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_RQE_QUEUE                 opennslBstStatIdRQEQueue</span>
<a name="l00074"></a><a class="code" href="example__bst_8c.html#a9439499311b1f2c9acdece1c6079e61b">00074</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_RQE_POOL                  opennslBstStatIdRQEPool</span>
<a name="l00075"></a><a class="code" href="example__bst_8c.html#a9a771f1c42a929c0d0dd0b7707396d1e">00075</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_UCAST_GROUP               opennslBstStatIdUcastGroup</span>
<a name="l00076"></a><a class="code" href="example__bst_8c.html#ab36ccc07a6a317cfd918312b8ce5a0a3">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_CPU                       opennslBstStatIdCpuQueue</span>
<a name="l00077"></a><a class="code" href="example__bst_8c.html#af0c4626f80886ca2687ba2ceae2ad267">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define _BST_STAT_ID_MAX_COUNT                 opennslBstStatIdMaxCount</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a>00079 <span class="comment">/*****************************************************************/</span>
<a name="l00087"></a><a class="code" href="example__bst_8c.html#ab09e0ef72430423530fa3a3c8434d47e">00087</a> <span class="keywordtype">int</span> <a class="code" href="example__bst_8c.html#ab09e0ef72430423530fa3a3c8434d47e" title="To set the default BST profiles.">example_bst_default_profile_set</a> (<span class="keywordtype">int</span> unit)
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089   <span class="keywordtype">int</span> rc;
<a name="l00090"></a>00090   <span class="keywordtype">int</span> bid;
<a name="l00091"></a>00091   <span class="keywordtype">int</span> depth;
<a name="l00092"></a>00092   <span class="keywordtype">int</span> index;
<a name="l00093"></a>00093   <span class="keywordtype">int</span> max_threshold;
<a name="l00094"></a>00094   <span class="keywordtype">int</span> max_ports;
<a name="l00095"></a>00095   <span class="keywordtype">int</span> gport;
<a name="l00096"></a>00096   <span class="keywordtype">int</span> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00097"></a>00097   <a class="code" href="structopennsl__cosq__bst__profile__s.html">opennsl_cosq_bst_profile_t</a> profile;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099   <span class="comment">/* Get maximum number of front panel ports available */</span>
<a name="l00100"></a>00100   <span class="keywordflow">if</span>((rc = <a class="code" href="examples_2util_8h.html#a0ec5a9523868f063b9ebfe4cfc05cdb1" title="To get the number of front panel ports.">example_max_port_count_get</a>(unit, &amp;max_ports)) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00101"></a>00101   {
<a name="l00102"></a>00102     printf(<span class="stringliteral">&quot;\r\nFailed to get number of front panel ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00103"></a>00103         rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00104"></a>00104     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="keywordflow">for</span> (bid = 0; bid &lt; <a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fac0c4e84a9fc5006e54bd424c26a6c68f" title="Must be the last.">opennslBstStatIdMaxCount</a>; bid++) {
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     <span class="comment">/* Find out the maximum threshold for a bid */</span>
<a name="l00110"></a>00110     <span class="keywordflow">if</span> (bid == <a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa3415972065e03b511eae195823824f1c" title="BST Tracing resource for unicast.">opennslBstStatIdUcast</a>              ||
<a name="l00111"></a>00111         bid == <a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa133237915251cc389e76f591cee31481" title="BST Tracing resource UC per egress port SP.">opennslBstStatIdEgrUCastPortShared</a> ||
<a name="l00112"></a>00112         bid == <a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa29e2fffb9b6efeefebf1a9446fea463a" title="BST Tracing resource per Ucast queue group.">opennslBstStatIdUcastGroup</a>) {
<a name="l00113"></a>00113       max_threshold =  0x3FFF * 208;
<a name="l00114"></a>00114     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bid == <a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa53412ca52b22caeb571d598bdb2bd1c5" title="Per Priority Group Headroom BST tracing resource.">opennslBstStatIdPriGroupHeadroom</a>) {
<a name="l00115"></a>00115       max_threshold =  0xFFF * 208;
<a name="l00116"></a>00116     } <span class="keywordflow">else</span> {
<a name="l00117"></a>00117       max_threshold =  0x1FFFF * 208;
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     profile.<a class="code" href="structopennsl__cosq__bst__profile__s.html#aa7ae80261744e2adb611ae31391b0548">byte</a> = max_threshold;
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <span class="keywordflow">if</span> (bid == <a class="code" href="example__bst_8c.html#af9fa8ed3df54173135be7fb6ab9c92d4">_BST_STAT_ID_EGR_POOL</a>              ||
<a name="l00123"></a>00123         bid == <a class="code" href="example__bst_8c.html#a6ac92692b0115a6357ed91ef3b6de831">_BST_STAT_ID_EGR_MCAST_POOL</a>        ||
<a name="l00124"></a>00124         bid == <a class="code" href="example__bst_8c.html#a7a5f9d9d2821ba06269f87a64ee28d10">_BST_STAT_ID_EGR_UCAST_PORT_SHARED</a> ||
<a name="l00125"></a>00125         bid == <a class="code" href="example__bst_8c.html#a9b7c22df5edbbab51e096438f2a3fda7">_BST_STAT_ID_EGR_PORT_SHARED</a>       ||
<a name="l00126"></a>00126         bid == <a class="code" href="example__bst_8c.html#a9a771f1c42a929c0d0dd0b7707396d1e">_BST_STAT_ID_UCAST_GROUP</a>           ||
<a name="l00127"></a>00127         bid == <a class="code" href="example__bst_8c.html#afbe8df21008aed42d2d55119d3f51681">_BST_STAT_ID_PORT_POOL</a>             ||
<a name="l00128"></a>00128         bid == <a class="code" href="example__bst_8c.html#a0a7fea14479b16553be4a990b27d9e45">_BST_STAT_ID_ING_POOL</a>)
<a name="l00129"></a>00129     {
<a name="l00130"></a>00130       depth = 4;
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bid == <a class="code" href="example__bst_8c.html#af63bf10310a35680b08a5200de43ea28">_BST_STAT_ID_PRI_GROUP_SHARED</a> ||
<a name="l00133"></a>00133         bid == <a class="code" href="example__bst_8c.html#aa9658a6f23dff63eb7adab39840529bb">_BST_STAT_ID_PRI_GROUP_HEADROOM</a>    ||
<a name="l00134"></a>00134         bid == <a class="code" href="example__bst_8c.html#a0dae4c3cdcb1e3ddbd80fab28ca7962b">_BST_STAT_ID_UCAST</a>                 ||
<a name="l00135"></a>00135         bid == <a class="code" href="example__bst_8c.html#a26f3850fc17989dac9e0a5d4c418f7ca">_BST_STAT_ID_MCAST</a>)
<a name="l00136"></a>00136     {
<a name="l00137"></a>00137       depth = 8;
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bid == <a class="code" href="example__bst_8c.html#af23204c398f6c8e8290b2d5fa112c856">_BST_STAT_ID_RQE_QUEUE</a>)
<a name="l00140"></a>00140     {
<a name="l00141"></a>00141       depth = 11;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143     <span class="keywordflow">else</span>
<a name="l00144"></a>00144     {
<a name="l00145"></a>00145       depth = 1;
<a name="l00146"></a>00146     }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="comment">/* Set default BST profiles */</span>
<a name="l00149"></a>00149     <span class="keywordflow">if</span> (bid == <a class="code" href="example__bst_8c.html#a0a7fea14479b16553be4a990b27d9e45">_BST_STAT_ID_ING_POOL</a>       ||
<a name="l00150"></a>00150         bid == <a class="code" href="example__bst_8c.html#a6ac92692b0115a6357ed91ef3b6de831">_BST_STAT_ID_EGR_MCAST_POOL</a> ||
<a name="l00151"></a>00151         bid == <a class="code" href="example__bst_8c.html#af9fa8ed3df54173135be7fb6ab9c92d4">_BST_STAT_ID_EGR_POOL</a>       ||
<a name="l00152"></a>00152         bid == <a class="code" href="example__bst_8c.html#af23204c398f6c8e8290b2d5fa112c856">_BST_STAT_ID_RQE_QUEUE</a>      ||
<a name="l00153"></a>00153         bid == <a class="code" href="example__bst_8c.html#a9a771f1c42a929c0d0dd0b7707396d1e">_BST_STAT_ID_UCAST_GROUP</a>    ||
<a name="l00154"></a>00154         bid == <a class="code" href="example__bst_8c.html#ad934a73a140f9a96329a91b4ff75d25a">_BST_STAT_ID_DEVICE</a>)
<a name="l00155"></a>00155     {
<a name="l00156"></a>00156        gport = 0;
<a name="l00157"></a>00157        <span class="keywordflow">for</span> (index = 0; index &lt; depth; index++)
<a name="l00158"></a>00158        {
<a name="l00159"></a>00159          rc = <a class="code" href="group__cosq.html#gacf09ea3a914f8bc61486ff0c43f5571e" title="Set/Get the BST profile for CosQ objects.">opennsl_cosq_bst_profile_set</a> (unit, gport, index, bid, &amp;profile);
<a name="l00160"></a>00160          <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00161"></a>00161          {
<a name="l00162"></a>00162            printf(<span class="stringliteral">&quot;\r\nFailed to set the BST profile for gport %d bid %d index %d, rc = %d (%s).\r\n&quot;</span>,
<a name="l00163"></a>00163                gport, bid, index, rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00164"></a>00164            <span class="keywordflow">return</span> rc;
<a name="l00165"></a>00165          }
<a name="l00166"></a>00166        } <span class="comment">/* Iter ... Cosq*/</span>
<a name="l00167"></a>00167     }
<a name="l00168"></a>00168     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bid == <a class="code" href="example__bst_8c.html#af63bf10310a35680b08a5200de43ea28">_BST_STAT_ID_PRI_GROUP_SHARED</a>      ||
<a name="l00169"></a>00169              bid == <a class="code" href="example__bst_8c.html#aa9658a6f23dff63eb7adab39840529bb">_BST_STAT_ID_PRI_GROUP_HEADROOM</a>    ||
<a name="l00170"></a>00170              bid == <a class="code" href="example__bst_8c.html#a0dae4c3cdcb1e3ddbd80fab28ca7962b">_BST_STAT_ID_UCAST</a>                 ||
<a name="l00171"></a>00171              bid == <a class="code" href="example__bst_8c.html#a26f3850fc17989dac9e0a5d4c418f7ca">_BST_STAT_ID_MCAST</a>                 ||
<a name="l00172"></a>00172              bid == <a class="code" href="example__bst_8c.html#afbe8df21008aed42d2d55119d3f51681">_BST_STAT_ID_PORT_POOL</a>             ||
<a name="l00173"></a>00173              bid == <a class="code" href="example__bst_8c.html#a9b7c22df5edbbab51e096438f2a3fda7">_BST_STAT_ID_EGR_PORT_SHARED</a>       ||
<a name="l00174"></a>00174              bid == <a class="code" href="example__bst_8c.html#a7a5f9d9d2821ba06269f87a64ee28d10">_BST_STAT_ID_EGR_UCAST_PORT_SHARED</a>)
<a name="l00175"></a>00175     {
<a name="l00176"></a>00176       <span class="keywordflow">for</span>(port = 1; port &lt; max_ports; port++)
<a name="l00177"></a>00177       {
<a name="l00178"></a>00178         <span class="comment">/* Get GPORT*/</span>
<a name="l00179"></a>00179         rc = <a class="code" href="group__port.html#gac3b1ddc83dbed38868b5ba256d29cdf7" title="Get the GPORT ID for the specified local port number.">opennsl_port_gport_get</a> (unit, port, &amp;gport);
<a name="l00180"></a>00180         <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00181"></a>00181         {
<a name="l00182"></a>00182            printf(<span class="stringliteral">&quot;\r\nFailed to get gport for port %d, rc = %d (%s).\r\n&quot;</span>,
<a name="l00183"></a>00183                port, rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00184"></a>00184            <span class="keywordflow">return</span> rc;
<a name="l00185"></a>00185         }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="keywordflow">for</span> (index = 0; index &lt; depth; index++)
<a name="l00188"></a>00188         {
<a name="l00189"></a>00189           rc = <a class="code" href="group__cosq.html#gacf09ea3a914f8bc61486ff0c43f5571e" title="Set/Get the BST profile for CosQ objects.">opennsl_cosq_bst_profile_set</a> (unit, gport, index, bid, &amp;profile);
<a name="l00190"></a>00190           <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00191"></a>00191           {
<a name="l00192"></a>00192             printf(<span class="stringliteral">&quot;\r\nFailed to set the BST profile for gport %d bid %d index %d, rc = %d (%s).\r\n&quot;</span>,
<a name="l00193"></a>00193                 gport, bid, index, rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00194"></a>00194             <span class="keywordflow">return</span> rc;
<a name="l00195"></a>00195           }
<a name="l00196"></a>00196         } <span class="comment">/* Iter ... index */</span>
<a name="l00197"></a>00197       } <span class="comment">/* Iter ... port */</span>
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   } <span class="comment">/* Iter ... bid */</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   <span class="keywordflow">return</span> 0;
<a name="l00203"></a>00203 }
<a name="l00204"></a>00204 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="comment">/*****************************************************************/</span>
<a name="l00218"></a><a class="code" href="example__bst_8c.html#ad4da6dd3323e1dc563dc7c3f30f56946">00218</a> <span class="keywordtype">void</span> <a class="code" href="example__bst_8c.html#ad4da6dd3323e1dc563dc7c3f30f56946" title="Callback function to capture BST triggers.">example_bst_trigger_callback</a> (<span class="keywordtype">int</span> unit, <a class="code" href="group__error.html#ga5f011dc99e86e654876271415d140e8d" title="Switch event types.">opennsl_switch_event_t</a> event,
<a name="l00219"></a>00219     <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> bid, <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>, <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> cosq, <span class="keywordtype">void</span> *cookie)
<a name="l00220"></a>00220 {
<a name="l00221"></a>00221   printf(<span class="stringliteral">&quot;BST trigger kicked in, event %d port %d bid %d cosq %d\n&quot;</span>, event, port, bid, cosq);
<a name="l00222"></a>00222   printf(<span class="stringliteral">&quot;BST feature is disabled.\n&quot;</span>);
<a name="l00223"></a>00223   <span class="keywordflow">return</span>;
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="comment">/*****************************************************************/</span>
<a name="l00234"></a>00234 <span class="comment">/* Main function for BST application */</span>
<a name="l00235"></a><a class="code" href="example__bst_8c.html#a0ddf1224851353fc92bfbff6f499fa97">00235</a> <span class="keywordtype">int</span> <a class="code" href="example__bst_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for bst sample application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00236"></a>00236 {
<a name="l00237"></a>00237   <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a>   rc;
<a name="l00238"></a>00238   <span class="keywordtype">int</span> choice;
<a name="l00239"></a>00239   <span class="keywordtype">int</span> unit = <a class="code" href="example__bst_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;
<a name="l00240"></a>00240   <span class="keywordtype">int</span> index,i,j;
<a name="l00241"></a>00241   <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> gport;
<a name="l00242"></a>00242   <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00243"></a>00243   <a class="code" href="group__types.html#gaf746bf383c3bd5c9de4bb442727a6405" title="opennsl_cos_queue_t">opennsl_cos_queue_t</a> cosq;
<a name="l00244"></a>00244   <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> options = 0;
<a name="l00245"></a>00245   <span class="keywordtype">void</span> *user_data = <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00246"></a>00246 
<a name="l00247"></a>00247   <a class="code" href="structexample__bst__counter__t.html">example_bst_counter_t</a> id_list[<a class="code" href="example__bst_8c.html#ae561a2dab8025f585c77571f67d4771e">MAX_COUNTERS</a>] = {
<a name="l00248"></a>00248     {<a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa3415972065e03b511eae195823824f1c" title="BST Tracing resource for unicast.">opennslBstStatIdUcast</a>,            <span class="stringliteral">&quot;opennslBstStatIdUcast&quot;</span>},
<a name="l00249"></a>00249     {<a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa8ccf39a2b35c55f6bdacc446acec2dec" title="BST Tracing resource for multicast.">opennslBstStatIdMcast</a>,            <span class="stringliteral">&quot;opennslBstStatIdMcast&quot;</span>},
<a name="l00250"></a>00250     {<a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa50195b3e9af232ba3d9d0d5b887fc6b2" title="Per Shared Priority Group Pool BST tracing resource.">opennslBstStatIdPriGroupShared</a>,   <span class="stringliteral">&quot;opennslBstStatIdPriGroupShared&quot;</span>},
<a name="l00251"></a>00251     {<a class="code" href="group__cosq.html#ggad2513b2cc3002680ce77d18a8b879e1fa53412ca52b22caeb571d598bdb2bd1c5" title="Per Priority Group Headroom BST tracing resource.">opennslBstStatIdPriGroupHeadroom</a>, <span class="stringliteral">&quot;opennslBstStatIdPriGroupHeadroom&quot;</span>}
<a name="l00252"></a>00252   };
<a name="l00253"></a>00253   <a class="code" href="sal_2types_8h.html#aa3ad64cf41ec3a042bd92550cc6ed308">uint64</a> val[<a class="code" href="example__bst_8c.html#ae561a2dab8025f585c77571f67d4771e">MAX_COUNTERS</a>][<a class="code" href="example__bst_8c.html#a20c3efb1df0911d9071bd4f9bf129acc">MAX_COSQ_COUNT</a>];
<a name="l00254"></a>00254 
<a name="l00255"></a>00255   <span class="comment">/* Intitializing val array */</span>
<a name="l00256"></a>00256   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="example__bst_8c.html#ae561a2dab8025f585c77571f67d4771e">MAX_COUNTERS</a>; i++) {
<a name="l00257"></a>00257     <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="example__bst_8c.html#a20c3efb1df0911d9071bd4f9bf129acc">MAX_COSQ_COUNT</a>; j++) {
<a name="l00258"></a>00258         val[i][j] = 0;
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260   }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <span class="keywordflow">if</span> ((argc != 1) || ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) {
<a name="l00263"></a>00263     printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__bst_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);
<a name="l00264"></a>00264     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00265"></a>00265   }
<a name="l00266"></a>00266 
<a name="l00267"></a>00267   <span class="comment">/* Initialize the system. */</span>
<a name="l00268"></a>00268   printf(<span class="stringliteral">&quot;Initializing the system.\r\n&quot;</span>);
<a name="l00269"></a>00269   rc = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00272"></a>00272     printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system, rc = %d (%s).\r\n&quot;</span>,
<a name="l00273"></a>00273            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00274"></a>00274     <span class="keywordflow">return</span> 0;
<a name="l00275"></a>00275   }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277   <span class="comment">/* Add ports to default vlan. */</span>
<a name="l00278"></a>00278   printf(<span class="stringliteral">&quot;Adding ports to default vlan.\r\n&quot;</span>);
<a name="l00279"></a>00279   rc = <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(unit);
<a name="l00280"></a>00280   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00281"></a>00281     printf(<span class="stringliteral">&quot;\r\nFailed to add default ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00282"></a>00282            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00283"></a>00283   }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285   rc = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);
<a name="l00286"></a>00286   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00287"></a>00287   {   
<a name="l00288"></a>00288     printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00289"></a>00289         rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00290"></a>00290   } 
<a name="l00291"></a>00291 
<a name="l00292"></a>00292   <span class="comment">/* Set default BST profiles */</span>
<a name="l00293"></a>00293   rc = <a class="code" href="example__bst_8c.html#ab09e0ef72430423530fa3a3c8434d47e" title="To set the default BST profiles.">example_bst_default_profile_set</a> (unit);
<a name="l00294"></a>00294   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00295"></a>00295     printf(<span class="stringliteral">&quot;\r\nFailed to set default profile for BST, rc = %d (%s).\r\n&quot;</span>,
<a name="l00296"></a>00296         rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00297"></a>00297   }
<a name="l00298"></a>00298   printf(<span class="stringliteral">&quot;Default BST profiles are set successfully.\r\n&quot;</span>);
<a name="l00299"></a>00299 
<a name="l00300"></a>00300   <span class="comment">/* Register Hw trigger callback*/</span>
<a name="l00301"></a>00301   rc = <a class="code" href="group__switch.html#ga74d72d311016b18d5a9bf98aec709c52" title="Registers/Unregisters a callback function for switch critical events.">opennsl_switch_event_register</a> (unit,
<a name="l00302"></a>00302       <a class="code" href="example__bst_8c.html#ad4da6dd3323e1dc563dc7c3f30f56946" title="Callback function to capture BST triggers.">example_bst_trigger_callback</a>,
<a name="l00303"></a>00303       user_data);
<a name="l00304"></a>00304   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00305"></a>00305   {
<a name="l00306"></a>00306     printf(<span class="stringliteral">&quot;\r\nFailed to register BST callback, rc = %d (%s).\r\n&quot;</span>,
<a name="l00307"></a>00307         rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00308"></a>00308     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00309"></a>00309   }
<a name="l00310"></a>00310   printf(<span class="stringliteral">&quot;BST callback for triggers is registered.\r\n&quot;</span>);
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   <span class="comment">/* Enabling bst module. */</span>
<a name="l00313"></a>00313   rc = <a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca6cef28f8214d21d47749799eeb840ff2" title="Enable BST tracking.">opennslSwitchBstEnable</a>, 1);
<a name="l00314"></a>00314   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00315"></a>00315     printf(<span class="stringliteral">&quot;\r\nFailed to Enable bst, rc = %d (%s).\r\n&quot;</span>,
<a name="l00316"></a>00316         rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00317"></a>00317     <span class="keywordflow">return</span> 0;
<a name="l00318"></a>00318   }
<a name="l00319"></a>00319   printf(<span class="stringliteral">&quot;BST feature is enabled.\r\n&quot;</span>);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 
<a name="l00322"></a>00322   <span class="keywordflow">while</span> (1) {
<a name="l00323"></a>00323     printf(<span class="stringliteral">&quot;\nUser Menu: Select one of the following options\n&quot;</span>);
<a name="l00324"></a>00324     printf(<span class="stringliteral">&quot;1. Enable/Disable BST feature.\n&quot;</span>);
<a name="l00325"></a>00325     printf(<span class="stringliteral">&quot;2. Display BST statistics of a port.\n&quot;</span>);
<a name="l00326"></a>00326     printf(<span class="stringliteral">&quot;3. Clear BST statistics of a port.\n&quot;</span>);
<a name="l00327"></a>00327 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00328"></a>00328 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);
<a name="l00329"></a>00329 <span class="preprocessor">#endif</span>
<a name="l00330"></a>00330 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application.\n&quot;</span>);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332     <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00333"></a>00333     {
<a name="l00334"></a>00334       printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00335"></a>00335       <span class="keywordflow">continue</span>;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337     <span class="keywordflow">switch</span>(choice) {
<a name="l00338"></a>00338 
<a name="l00339"></a>00339       <span class="keywordflow">case</span> 1:
<a name="l00340"></a>00340         {
<a name="l00341"></a>00341           printf(<span class="stringliteral">&quot;\r\nConfigure BST feature: 1-Enable, 0-Disable.\r\n&quot;</span>);
<a name="l00342"></a>00342           <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00343"></a>00343           {
<a name="l00344"></a>00344             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00345"></a>00345             <span class="keywordflow">continue</span>;
<a name="l00346"></a>00346           }
<a name="l00347"></a>00347           <span class="keywordflow">if</span>((choice != 0) &amp;&amp; (choice != 1))
<a name="l00348"></a>00348           {
<a name="l00349"></a>00349             printf(<span class="stringliteral">&quot;Invalid input. Please re-enter.\n&quot;</span>);
<a name="l00350"></a>00350             <span class="keywordflow">continue</span>;
<a name="l00351"></a>00351           }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353           rc = <a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca6cef28f8214d21d47749799eeb840ff2" title="Enable BST tracking.">opennslSwitchBstEnable</a>, choice);
<a name="l00354"></a>00354           <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00355"></a>00355             printf(<span class="stringliteral">&quot;\r\nFailed to %s BST feature, rc = %d (%s).\r\n&quot;</span>,
<a name="l00356"></a>00356                 (choice == 0)? <span class="stringliteral">&quot;Disable&quot;</span> : <span class="stringliteral">&quot;Enable&quot;</span>, rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00357"></a>00357             <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00358"></a>00358           }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360           printf(<span class="stringliteral">&quot;BST feature is %s.\r\n&quot;</span>, (choice == 0)? <span class="stringliteral">&quot;Disabled&quot;</span> : <span class="stringliteral">&quot;Enabled&quot;</span>);
<a name="l00361"></a>00361           <span class="keywordflow">break</span>;
<a name="l00362"></a>00362         } <span class="comment">/* End of case 1 */</span>
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       <span class="keywordflow">case</span> 2:
<a name="l00365"></a>00365         {
<a name="l00366"></a>00366           printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00367"></a>00367           <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00368"></a>00368           {
<a name="l00369"></a>00369             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00370"></a>00370             <span class="keywordflow">continue</span>;
<a name="l00371"></a>00371           }
<a name="l00372"></a>00372           rc = <a class="code" href="group__port.html#gac3b1ddc83dbed38868b5ba256d29cdf7" title="Get the GPORT ID for the specified local port number.">opennsl_port_gport_get</a> (unit, port, &amp;gport);
<a name="l00373"></a>00373           <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00374"></a>00374           {
<a name="l00375"></a>00375             <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00376"></a>00376           }
<a name="l00377"></a>00377           <span class="keywordflow">for</span> (index = 0; index &lt; MAX_COUNTERS; index++)
<a name="l00378"></a>00378           {
<a name="l00379"></a>00379             rc = (<a class="code" href="group__cosq.html#ga16395745326578895d5d025000030a07" title="Sync the HW stats value to SW copy for all or given BST resource.">opennsl_cosq_bst_stat_sync</a>(unit, id_list[index].bid));
<a name="l00380"></a>00380             <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00381"></a>00381             printf(<span class="stringliteral">&quot;\r\nFailed to sync the state of port, rc = %d (%s).\r\n&quot;</span>,
<a name="l00382"></a>00382                    rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00383"></a>00383             <span class="keywordflow">break</span>;
<a name="l00384"></a>00384           }
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         <span class="keywordflow">for</span> (index = 0; index &lt; MAX_COUNTERS; index++)
<a name="l00388"></a>00388         {
<a name="l00389"></a>00389           <span class="keywordflow">for</span> (cosq = 0; cosq &lt;=7; cosq++)
<a name="l00390"></a>00390           {
<a name="l00391"></a>00391             rc = <a class="code" href="group__cosq.html#gafb618145bceb834e7e0d62622f3174eb" title="Get the current statistic/count of specified BST profile.">opennsl_cosq_bst_stat_get</a>(unit, gport, cosq,
<a name="l00392"></a>00392                 id_list[index].bid, options, &amp;val[index][cosq]);
<a name="l00393"></a>00393             <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00394"></a>00394               printf(<span class="stringliteral">&quot;\r\nFailed to get the port stats, rc = %d (%s).\r\n&quot;</span>,
<a name="l00395"></a>00395                      rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00396"></a>00396               <span class="keywordflow">break</span>;
<a name="l00397"></a>00397             }
<a name="l00398"></a>00398             printf(<span class="stringliteral">&quot;BST Counter: %s for COS queue: %d is : %llu\n&quot;</span>,
<a name="l00399"></a>00399                 id_list[index].name, cosq, val[index][cosq]);
<a name="l00400"></a>00400           }
<a name="l00401"></a>00401           printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404         <span class="keywordflow">break</span>;
<a name="l00405"></a>00405       } <span class="comment">/* End of case 2 */</span>
<a name="l00406"></a>00406 
<a name="l00407"></a>00407       <span class="keywordflow">case</span> 3:
<a name="l00408"></a>00408       {
<a name="l00409"></a>00409         printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00410"></a>00410         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00411"></a>00411         {
<a name="l00412"></a>00412             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00413"></a>00413             <span class="keywordflow">continue</span>;
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415         rc = <a class="code" href="group__port.html#gac3b1ddc83dbed38868b5ba256d29cdf7" title="Get the GPORT ID for the specified local port number.">opennsl_port_gport_get</a> (unit, port, &amp;gport);
<a name="l00416"></a>00416         <span class="keywordflow">if</span> (rc!= <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00417"></a>00417         {
<a name="l00418"></a>00418           <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00419"></a>00419         }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keywordflow">for</span> (index = 0; index &lt; MAX_COUNTERS; index++)
<a name="l00422"></a>00422         {
<a name="l00423"></a>00423           <span class="keywordflow">for</span> (cosq = 0; cosq &lt;= 7; cosq++)
<a name="l00424"></a>00424           {
<a name="l00425"></a>00425             rc = <a class="code" href="group__cosq.html#ga98ae2a8fe5ee8b19dd7cdae16342de50" title="Clear the current statistic/count of specified BST profile.">opennsl_cosq_bst_stat_clear</a>(unit, gport, cosq,
<a name="l00426"></a>00426                 id_list[index].bid);
<a name="l00427"></a>00427             <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00428"></a>00428               printf(<span class="stringliteral">&quot;\r\nFailed to clear the port stats, rc = %d (%s).\r\n&quot;</span>,
<a name="l00429"></a>00429                      rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00430"></a>00430               <span class="keywordflow">break</span>;
<a name="l00431"></a>00431             }
<a name="l00432"></a>00432           }
<a name="l00433"></a>00433           printf(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436         printf(<span class="stringliteral">&quot;\r\nPort %d stats cleared\r\n&quot;</span>, port);
<a name="l00437"></a>00437         <span class="keywordflow">break</span>;
<a name="l00438"></a>00438       } <span class="comment">/* End of case 3 */</span>
<a name="l00439"></a>00439 
<a name="l00440"></a>00440 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00441"></a>00441 <span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:
<a name="l00442"></a>00442       {
<a name="l00443"></a>00443         opennsl_driver_shell();
<a name="l00444"></a>00444         <span class="keywordflow">break</span>;
<a name="l00445"></a>00445       }
<a name="l00446"></a>00446 <span class="preprocessor">#endif</span>
<a name="l00447"></a>00447 <span class="preprocessor"></span>
<a name="l00448"></a>00448       <span class="keywordflow">case</span> 0:
<a name="l00449"></a>00449       {
<a name="l00450"></a>00450         printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);
<a name="l00451"></a>00451         <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00452"></a>00452       }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454       <span class="keywordflow">default</span> :
<a name="l00455"></a>00455         <span class="keywordflow">break</span>;
<a name="l00456"></a>00456     } <span class="comment">/* End of switch */</span>
<a name="l00457"></a>00457   } <span class="comment">/* End of while */</span>
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <span class="keywordflow">return</span> 0;
<a name="l00460"></a>00460 }
<a name="l00461"></a>00461 <span class="comment">/* __doxy_func_body_end__ */</span>
</pre></div></div>
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016 by Broadcom Corporation. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Corporation reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Corporation is believed to be accurate and reliable. However, Broadcom Corporation does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->



<!--BEGIN !GENERATE_TREEVIEW-->
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
