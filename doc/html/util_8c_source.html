<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/util.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen/doxygen_brcm.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/util.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="util_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2017</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> * \file     util.c</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * \brief    OpenNSL utility routines required for example applications</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * \details  OpenNSL utility routines required for example applications</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> ************************************************************************/</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">opennsl/init.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="l2_8h.html">opennsl/l2.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="stg_8h.html">opennsl/stg.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="link_8h.html">opennsl/link.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="util_8c.html#a91668ed1245d073a2ac84e6121205d28">00038</a> <span class="preprocessor">#define DEFAULT_VLAN          1</span>
<a name="l00039"></a><a class="code" href="util_8c.html#a068278b0838b6670ab0ab0a93ed77484">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_DIGITS_IN_CHOICE  5</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="comment">/*************************************************************************/</span>
<a name="l00051"></a><a class="code" href="util_8c.html#a0c51b0c053abe73fa4c2f755a0b276e1">00051</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a0c51b0c053abe73fa4c2f755a0b276e1" title="Returns true if the device belongs to DNX family of devices.">example_is_dnx_device</a>(<span class="keywordtype">int</span> unit)
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053   <span class="keywordtype">int</span> rv = <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00054"></a>00054   <a class="code" href="structopennsl__info__s.html" title="OPENNSL Information structure.">opennsl_info_t</a> info;
<a name="l00055"></a>00055   <a class="code" href="group__init.html#ga64691ef7b923460206cd9abb675807c0" title="Get information about a OPENNSL unit.">opennsl_info_get</a>(unit, &amp;info);
<a name="l00056"></a>00056 
<a name="l00057"></a>00057   <span class="keywordflow">if</span>(info.<a class="code" href="structopennsl__info__s.html#aae207acb2f24ca559828a25160fccaca" title="PCI values used usually.">device</a> == 0x8375) <span class="comment">/* Qumran MX */</span>
<a name="l00058"></a>00058   {
<a name="l00059"></a>00059     rv = <a class="code" href="sal_2types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00060"></a>00060   }
<a name="l00061"></a>00061   <span class="keywordflow">return</span> rv;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00064"></a>00064 
<a name="l00065"></a>00065 <span class="comment">/*************************************************************************/</span>
<a name="l00075"></a><a class="code" href="util_8c.html#a131ca7039d41fc26c375479724d2f903">00075</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a131ca7039d41fc26c375479724d2f903" title="Returns true if the device is Qumran-MX device.">example_is_qmx_device</a>(<span class="keywordtype">int</span> unit)
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077   <span class="keywordtype">int</span> rv = <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00078"></a>00078   <a class="code" href="structopennsl__info__s.html" title="OPENNSL Information structure.">opennsl_info_t</a> info;
<a name="l00079"></a>00079   <a class="code" href="group__init.html#ga64691ef7b923460206cd9abb675807c0" title="Get information about a OPENNSL unit.">opennsl_info_get</a>(unit, &amp;info);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="keywordflow">if</span>(info.<a class="code" href="structopennsl__info__s.html#aae207acb2f24ca559828a25160fccaca" title="PCI values used usually.">device</a> == 0x8375) <span class="comment">/* Qumran MX */</span>
<a name="l00082"></a>00082   {
<a name="l00083"></a>00083     rv = <a class="code" href="sal_2types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00084"></a>00084   }
<a name="l00085"></a>00085   <span class="keywordflow">return</span> rv;
<a name="l00086"></a>00086 }
<a name="l00087"></a>00087 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="comment">/*****************************************************************/</span>
<a name="l00097"></a><a class="code" href="util_8c.html#a2846e8ec8f46d212a3ae2493bdff7980">00097</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(<span class="keywordtype">int</span> unit)
<a name="l00098"></a>00098 {
<a name="l00099"></a>00099   <a class="code" href="structopennsl__port__config__s.html" title="Port Configuration structure.">opennsl_port_config_t</a> pcfg;
<a name="l00100"></a>00100   <a class="code" href="structopennsl__port__info__s.html" title="opennsl_port_info_s">opennsl_port_info_t</a> info;
<a name="l00101"></a>00101   <span class="keywordtype">int</span> rv;
<a name="l00102"></a>00102   <span class="keywordtype">int</span> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00103"></a>00103   <span class="keywordtype">int</span> stp_state = <a class="code" href="group__stg.html#gga9d59789af75382e059ed70a13fb4efe1adccd387496b817e57070e97510521094" title="Normal operation.">OPENNSL_STG_STP_FORWARD</a>;
<a name="l00104"></a>00104   <span class="keywordtype">int</span> stg = 1;
<a name="l00105"></a>00105   <span class="keywordtype">int</span> dnx_device = <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   dnx_device = <a class="code" href="examples_2util_8h.html#a0c51b0c053abe73fa4c2f755a0b276e1" title="Returns true if the device belongs to DNX family of devices.">example_is_dnx_device</a>(unit);
<a name="l00108"></a>00108   <span class="comment">/*</span>
<a name="l00109"></a>00109 <span class="comment">   * Create VLAN with id DEFAULT_VLAN and</span>
<a name="l00110"></a>00110 <span class="comment">   * add ethernet ports to the VLAN</span>
<a name="l00111"></a>00111 <span class="comment">   */</span>
<a name="l00112"></a>00112   <a class="code" href="group__port.html#gabf1a5c9a87a76f4b9fa23ccf6a210124" title="Initialize a Port Configuration structure.">opennsl_port_config_t_init</a>(&amp;pcfg);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   rv = <a class="code" href="group__port.html#ga9f95e3f27b53970914dccc70ffbe7010" title="Retrieved the port configuration for the specified device.">opennsl_port_config_get</a>(unit, &amp;pcfg);
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00116"></a>00116   {
<a name="l00117"></a>00117     printf(<span class="stringliteral">&quot;Failed to get port configuration. Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00118"></a>00118     <span class="keywordflow">return</span> rv;
<a name="l00119"></a>00119   }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="comment">/* Set the STP state to forward in default STG for all ports */</span>
<a name="l00122"></a>00122   <a class="code" href="group__types.html#ga742e22658005a7f2772423ba8af9077d">OPENNSL_PBMP_ITER</a>(pcfg.<a class="code" href="structopennsl__port__config__s.html#afc418db09422234cc8de20841fa71f86" title="Mask of eth ports.">e</a>, port)
<a name="l00123"></a>00123   {
<a name="l00124"></a>00124     rv = <a class="code" href="group__stg.html#gac4824e77e2d0cd577a9962d63e5b53ac" title="Set the Spanning Tree Protocol state of a port/VP in the specified STG.">opennsl_stg_stp_set</a>(unit, stg, port, stp_state);
<a name="l00125"></a>00125     <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00126"></a>00126     {
<a name="l00127"></a>00127       printf(<span class="stringliteral">&quot;Failed to set STP state for unit %d port %d, Error %s\n&quot;</span>,
<a name="l00128"></a>00128           unit, port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00129"></a>00129       <span class="keywordflow">return</span> rv;
<a name="l00130"></a>00130     }
<a name="l00131"></a>00131   }
<a name="l00132"></a>00132 
<a name="l00133"></a>00133   <span class="comment">/* Setup default configuration on the ports */</span>
<a name="l00134"></a>00134   <a class="code" href="group__port.html#gad4f4937a2c1eb33233b93e68b33fba36" title="Initializes the opennsl_port_info_t structure.">opennsl_port_info_t_init</a>(&amp;info);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136   <span class="keywordflow">if</span>(dnx_device == <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00137"></a>00137   {
<a name="l00138"></a>00138     info.<a class="code" href="structopennsl__port__info__s.html#a0069f6f0d55b1b5819d23ec3f4f3e5c7">speed</a>        = 0;
<a name="l00139"></a>00139   }
<a name="l00140"></a>00140   info.<a class="code" href="structopennsl__port__info__s.html#a3c1901e3d5898180c34f62e73cc6dc46">duplex</a>       = <a class="code" href="group__port.html#ga4ea82680aad05dc9cb0b9fbf729b43f5">OPENNSL_PORT_DUPLEX_FULL</a>;
<a name="l00141"></a>00141   info.<a class="code" href="structopennsl__port__info__s.html#a5bc0c98dc36de3728b5c5bd905ac6536">pause_rx</a>     = <a class="code" href="group__port.html#ga27b9ba812dfbf680236baa0255552b8e">OPENNSL_PORT_ABILITY_PAUSE_RX</a>;
<a name="l00142"></a>00142   info.<a class="code" href="structopennsl__port__info__s.html#a49a5c75b091b95d0192e55f8d952623b">pause_tx</a>     = <a class="code" href="group__port.html#gadef0c0114c88d72d85887f8e978f6328">OPENNSL_PORT_ABILITY_PAUSE_TX</a>;
<a name="l00143"></a>00143   info.<a class="code" href="structopennsl__port__info__s.html#aa0377a774204e16b6eaaef1268b6fa1d">linkscan</a>     = <a class="code" href="group__link.html#gga09ea64aace464cf0b4cec10763102b5fa85193be37417b622791110c618ab6c6b">OPENNSL_LINKSCAN_MODE_SW</a>;
<a name="l00144"></a>00144   info.<a class="code" href="structopennsl__port__info__s.html#a7bd9ca2f39a10455696871ca7e1f7d8e">autoneg</a>      = <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00145"></a>00145   info.<a class="code" href="structopennsl__port__info__s.html#a8d98a4c0b7fb37caa75ebd0e40b51e83">enable</a> = 1;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   info.<a class="code" href="structopennsl__port__info__s.html#a61a500c509e874b958c5062fe66a2b2c" title="OPENNSL_PORT_ATTR_xxx.">action_mask</a> |= ( <a class="code" href="group__port.html#ga4a027cbb9a96a7aed7f79251d4a02f8f">OPENNSL_PORT_ATTR_AUTONEG_MASK</a> |
<a name="l00148"></a>00148       <a class="code" href="group__port.html#ga0dcee148c7a1f69ab112616b5dbb6344">OPENNSL_PORT_ATTR_DUPLEX_MASK</a>   |
<a name="l00149"></a>00149       <a class="code" href="group__port.html#gad0d00f6d36024409b0c791ab3c59d8df">OPENNSL_PORT_ATTR_PAUSE_RX_MASK</a> |
<a name="l00150"></a>00150       <a class="code" href="group__port.html#gad31ce8a9bd5fc99fdd80e916c9c32114">OPENNSL_PORT_ATTR_PAUSE_TX_MASK</a> |
<a name="l00151"></a>00151       <a class="code" href="group__port.html#ga538c83c76a5556a14f9bc94a5dc5e6b4">OPENNSL_PORT_ATTR_LINKSCAN_MASK</a> |
<a name="l00152"></a>00152       <a class="code" href="group__port.html#ga1a3b9a173ae1a9708614656794422e12">OPENNSL_PORT_ATTR_ENABLE_MASK</a>   );
<a name="l00153"></a>00153 
<a name="l00154"></a>00154   <span class="keywordflow">if</span>(dnx_device == <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00155"></a>00155   {
<a name="l00156"></a>00156     info.<a class="code" href="structopennsl__port__info__s.html#a61a500c509e874b958c5062fe66a2b2c" title="OPENNSL_PORT_ATTR_xxx.">action_mask</a> |= <a class="code" href="group__port.html#ga3b1dd6445e115b3b21b93e9798c0598a">OPENNSL_PORT_ATTR_SPEED_MASK</a>;
<a name="l00157"></a>00157   }
<a name="l00158"></a>00158   <a class="code" href="group__types.html#ga742e22658005a7f2772423ba8af9077d">OPENNSL_PBMP_ITER</a>(pcfg.<a class="code" href="structopennsl__port__config__s.html#afc418db09422234cc8de20841fa71f86" title="Mask of eth ports.">e</a>, port)
<a name="l00159"></a>00159   {
<a name="l00160"></a>00160     rv = <a class="code" href="group__port.html#gacdeec38f5023bdd0132b4d4d973ab5fd" title="Get or set multiple port characteristics.">opennsl_port_selective_set</a>(unit, port, &amp;info);
<a name="l00161"></a>00161     <span class="keywordflow">if</span> (<a class="code" href="group__error.html#ga655eb72518850235a4c759ddceb622e6">OPENNSL_FAILURE</a>(rv))
<a name="l00162"></a>00162     {
<a name="l00163"></a>00163       printf(<span class="stringliteral">&quot;Failed to set port config for unit %d, port %d, Error %s&quot;</span>,
<a name="l00164"></a>00164           unit, port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00165"></a>00165       <span class="keywordflow">return</span> rv;
<a name="l00166"></a>00166     }
<a name="l00167"></a>00167   }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169   <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00170"></a>00170 }
<a name="l00171"></a>00171 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00172"></a>00172 
<a name="l00173"></a>00173 <span class="comment">/*****************************************************************/</span>
<a name="l00180"></a><a class="code" href="util_8c.html#a2d14e4de1f4a7192ac7e378f8f7c63ff">00180</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(<span class="keywordtype">int</span> unit)
<a name="l00181"></a>00181 {
<a name="l00182"></a>00182   <a class="code" href="structopennsl__port__config__s.html" title="Port Configuration structure.">opennsl_port_config_t</a> pcfg;
<a name="l00183"></a>00183   <span class="keywordtype">int</span> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00184"></a>00184   <span class="keywordtype">int</span> rv;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="comment">/*</span>
<a name="l00187"></a>00187 <span class="comment">   * Create VLAN with id DEFAULT_VLAN and</span>
<a name="l00188"></a>00188 <span class="comment">   * add ethernet ports to the VLAN</span>
<a name="l00189"></a>00189 <span class="comment">   */</span>
<a name="l00190"></a>00190   rv = <a class="code" href="group__port.html#ga9f95e3f27b53970914dccc70ffbe7010" title="Retrieved the port configuration for the specified device.">opennsl_port_config_get</a>(unit, &amp;pcfg);
<a name="l00191"></a>00191   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00192"></a>00192     printf(<span class="stringliteral">&quot;Failed to get port configuration. Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00193"></a>00193     <span class="keywordflow">return</span> rv;
<a name="l00194"></a>00194   }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196   rv = <a class="code" href="group__vlan.html#ga1e7cecaf6718cd174f1b1aef29349340" title="Add ports to the specified VLAN.">opennsl_vlan_port_add</a>(unit, <a class="code" href="util_8c.html#a91668ed1245d073a2ac84e6121205d28">DEFAULT_VLAN</a>, pcfg.<a class="code" href="structopennsl__port__config__s.html#afc418db09422234cc8de20841fa71f86" title="Mask of eth ports.">e</a>, pcfg.<a class="code" href="structopennsl__port__config__s.html#afc418db09422234cc8de20841fa71f86" title="Mask of eth ports.">e</a>);
<a name="l00197"></a>00197   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00198"></a>00198     printf(<span class="stringliteral">&quot;Failed to add ports to VLAN. Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00199"></a>00199     <span class="keywordflow">return</span> rv;
<a name="l00200"></a>00200   }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202   <a class="code" href="group__types.html#ga742e22658005a7f2772423ba8af9077d">OPENNSL_PBMP_ITER</a>(pcfg.<a class="code" href="structopennsl__port__config__s.html#afc418db09422234cc8de20841fa71f86" title="Mask of eth ports.">e</a>, port)
<a name="l00203"></a>00203   {
<a name="l00204"></a>00204     rv = <a class="code" href="group__port.html#gaa3747d513cfc9205b8ee738cba1910c1" title="Get or set the default VLAN for packets that ingress untagged.">opennsl_port_untagged_vlan_set</a>(unit, port, <a class="code" href="util_8c.html#a91668ed1245d073a2ac84e6121205d28">DEFAULT_VLAN</a>);
<a name="l00205"></a>00205     <span class="keywordflow">if</span> (<a class="code" href="group__error.html#ga655eb72518850235a4c759ddceb622e6">OPENNSL_FAILURE</a>(rv))
<a name="l00206"></a>00206     {
<a name="l00207"></a>00207       printf(<span class="stringliteral">&quot;Failed to set port untagged VLAN for unit %d, port %d, Error %s&quot;</span>,
<a name="l00208"></a>00208           unit, port, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00209"></a>00209       <span class="keywordflow">return</span> rv;
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211   }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213   <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="comment">/**************************************************************************/</span>
<a name="l00225"></a><a class="code" href="util_8c.html#aaaf82384f15fd6b2295de85ad6529ecc">00225</a> <span class="keywordtype">char</span> *<a class="code" href="examples_2util_8h.html#aaaf82384f15fd6b2295de85ad6529ecc" title="Read a string from user.">example_read_user_string</a>(<span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> buflen)
<a name="l00226"></a>00226 {
<a name="l00227"></a>00227   <span class="keywordtype">int</span> ch;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229   <span class="keywordflow">if</span> (fgets(buf, buflen, stdin) != 0)
<a name="l00230"></a>00230   {
<a name="l00231"></a>00231     <span class="keywordtype">size_t</span> len = strlen(buf);
<a name="l00232"></a>00232     <span class="keywordflow">if</span> (len &gt; 0 &amp;&amp; buf[len-1] == <span class="charliteral">&#39;\n&#39;</span>)
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234       buf[len-1] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236     <span class="keywordflow">else</span>
<a name="l00237"></a>00237     {
<a name="l00238"></a>00238       <span class="keywordflow">while</span> ((ch = getc(stdin)) != EOF &amp;&amp; ch != <span class="charliteral">&#39;\n&#39;</span>);
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240     <span class="keywordflow">return</span> buf;
<a name="l00241"></a>00241   }
<a name="l00242"></a>00242   <span class="keywordflow">return</span> 0;
<a name="l00243"></a>00243 }
<a name="l00244"></a>00244 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00245"></a>00245 <span class="comment">/**************************************************************************/</span>
<a name="l00252"></a><a class="code" href="util_8c.html#ad0173c952d5a8af01c14eebabc05b5df">00252</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(<span class="keywordtype">int</span> *choice)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254   <span class="keywordtype">char</span> val;
<a name="l00255"></a>00255   <span class="keywordtype">char</span> digits[<a class="code" href="util_8c.html#a068278b0838b6670ab0ab0a93ed77484">MAX_DIGITS_IN_CHOICE</a> + 1];
<a name="l00256"></a>00256   <span class="keywordtype">int</span> idx = 0;
<a name="l00257"></a>00257   <span class="keywordtype">int</span> valid = <a class="code" href="sal_2types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00258"></a>00258 
<a name="l00259"></a>00259   <span class="comment">/* parse input string until \n */</span>
<a name="l00260"></a>00260   <span class="keywordflow">while</span>((val = getchar()) != <span class="charliteral">&#39;\n&#39;</span>)
<a name="l00261"></a>00261   {
<a name="l00262"></a>00262     <span class="keywordflow">if</span> ((val &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; val &lt;= <span class="charliteral">&#39;9&#39;</span>) &amp;&amp; idx &lt; <a class="code" href="util_8c.html#a068278b0838b6670ab0ab0a93ed77484">MAX_DIGITS_IN_CHOICE</a>)
<a name="l00263"></a>00263     {
<a name="l00264"></a>00264       digits[idx++] = val;
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     <span class="keywordflow">else</span>
<a name="l00267"></a>00267     {
<a name="l00268"></a>00268       valid = <a class="code" href="sal_2types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00269"></a>00269     }
<a name="l00270"></a>00270   }
<a name="l00271"></a>00271   <span class="keywordflow">if</span> ((valid == <a class="code" href="sal_2types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) &amp;&amp; idx != 0)
<a name="l00272"></a>00272   {
<a name="l00273"></a>00273     digits[idx] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00274"></a>00274     *choice = atoi(digits);
<a name="l00275"></a>00275     <span class="keywordflow">return</span>(<a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>);
<a name="l00276"></a>00276   }
<a name="l00277"></a>00277   <span class="keywordflow">else</span>
<a name="l00278"></a>00278   {
<a name="l00279"></a>00279     *choice = -1;
<a name="l00280"></a>00280     <span class="keywordflow">return</span>(<a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>);
<a name="l00281"></a>00281   }
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="comment">/*****************************************************************/</span>
<a name="l00293"></a><a class="code" href="util_8c.html#abdc906039b3b47e6213585346a0ad1e6">00293</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#abdc906039b3b47e6213585346a0ad1e6" title="Parse MAC address string.">opennsl_mac_parse</a>(<span class="keywordtype">char</span> *buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *macp)
<a name="l00294"></a>00294 {
<a name="l00295"></a>00295   <span class="keywordtype">int</span>   i, c1, c2;
<a name="l00296"></a>00296   <span class="keywordtype">char</span>  *s;
<a name="l00297"></a>00297 <span class="preprocessor">#define MAC_ADDR_LEN 17</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span>
<a name="l00299"></a>00299   macp[0] = macp[1] = macp[2] = 0;
<a name="l00300"></a>00300   macp[3] = macp[4] = macp[5] = 0;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302   <span class="keywordflow">if</span> ((buf == <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (strlen(buf) &gt; <a class="code" href="util_8c.html#a60cf9af36f952be0feb59d1f49d5edff">MAC_ADDR_LEN</a>)) {
<a name="l00303"></a>00303     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00304"></a>00304   }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <span class="comment">/* skip leading 0x if plain hex format */</span>
<a name="l00307"></a>00307   <span class="keywordflow">if</span> (buf[0] == <span class="charliteral">&#39;0&#39;</span> &amp;&amp; (buf[1] == <span class="charliteral">&#39;x&#39;</span> || buf[1] == <span class="charliteral">&#39;X&#39;</span>)) {
<a name="l00308"></a>00308     buf += 2;
<a name="l00309"></a>00309   }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311   <span class="comment">/* start at end of string and work backwards */</span>
<a name="l00312"></a>00312   <span class="keywordflow">for</span> (s = buf; *s; s++) {
<a name="l00313"></a>00313     ;
<a name="l00314"></a>00314   }
<a name="l00315"></a>00315   <span class="keywordflow">for</span> (i = 5; i &gt;= 0 &amp;&amp; s &gt;= buf; i--) {
<a name="l00316"></a>00316     c1 = c2 = 0;
<a name="l00317"></a>00317     <span class="keywordflow">if</span> (--s &gt;= buf) {
<a name="l00318"></a>00318       <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) {
<a name="l00319"></a>00319         c2 = *s - <span class="charliteral">&#39;0&#39;</span>;
<a name="l00320"></a>00320       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;f&#39;</span>) {
<a name="l00321"></a>00321         c2 = *s - <span class="charliteral">&#39;a&#39;</span> + 10;
<a name="l00322"></a>00322       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;F&#39;</span>) {
<a name="l00323"></a>00323         c2 = *s - <span class="charliteral">&#39;A&#39;</span> + 10;
<a name="l00324"></a>00324       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;:&#39;</span>) {
<a name="l00325"></a>00325         ;
<a name="l00326"></a>00326       } <span class="keywordflow">else</span> {
<a name="l00327"></a>00327         <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00328"></a>00328       }
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330     <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;:&#39;</span> &amp;&amp; --s &gt;= buf) {
<a name="l00331"></a>00331       <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>) {
<a name="l00332"></a>00332         c1 = *s - <span class="charliteral">&#39;0&#39;</span>;
<a name="l00333"></a>00333       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;f&#39;</span>) {
<a name="l00334"></a>00334         c1 = *s - <span class="charliteral">&#39;a&#39;</span> + 10;
<a name="l00335"></a>00335       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;F&#39;</span>) {
<a name="l00336"></a>00336         c1 = *s - <span class="charliteral">&#39;A&#39;</span> + 10;
<a name="l00337"></a>00337       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;:&#39;</span>) {
<a name="l00338"></a>00338         ;
<a name="l00339"></a>00339       } <span class="keywordflow">else</span> {
<a name="l00340"></a>00340         <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342     }
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     <span class="keywordflow">if</span> (s &gt; buf &amp;&amp; s[-1] == <span class="charliteral">&#39;:&#39;</span>) {
<a name="l00345"></a>00345       --s;
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347     macp[i] = c1 &lt;&lt; 4 | c2;
<a name="l00348"></a>00348   }
<a name="l00349"></a>00349   <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00350"></a>00350 }
<a name="l00351"></a>00351 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 <span class="comment">/*****************************************************************/</span>
<a name="l00358"></a><a class="code" href="util_8c.html#a3262fde70495cd6e0f3afd6baf9ae95c">00358</a> <span class="keywordtype">void</span> <a class="code" href="examples_2util_8h.html#a3262fde70495cd6e0f3afd6baf9ae95c" title="To print the MAC address.">l2_print_mac</a>(<span class="keywordtype">char</span> *str, <a class="code" href="group__types.html#ga016605921f5a8bd7ed96bb1b6195178a" title="opennsl_mac_t">opennsl_mac_t</a> mac_address){
<a name="l00359"></a>00359   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> a,b,c,d,e,f;
<a name="l00360"></a>00360   a = 0xff &amp; mac_address[0];
<a name="l00361"></a>00361   b = 0xff &amp; mac_address[1];
<a name="l00362"></a>00362   c = 0xff &amp; mac_address[2];
<a name="l00363"></a>00363   d = 0xff &amp; mac_address[3];
<a name="l00364"></a>00364   e = 0xff &amp; mac_address[4];
<a name="l00365"></a>00365   f = 0xff &amp; mac_address[5];
<a name="l00366"></a>00366   printf(<span class="stringliteral">&quot;%s %02x:%02x:%02x:%02x:%02x:%02x&quot;</span>,
<a name="l00367"></a>00367       str,
<a name="l00368"></a>00368       a,b,c,
<a name="l00369"></a>00369       d,e,f);
<a name="l00370"></a>00370   <span class="keywordflow">return</span>;
<a name="l00371"></a>00371 }
<a name="l00372"></a>00372 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="comment">/*****************************************************************/</span>
<a name="l00382"></a><a class="code" href="util_8c.html#a585b98d1b722f370f0568053ba451845">00382</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a585b98d1b722f370f0568053ba451845" title="Parse IP string into a IP value.">opennsl_ip_parse</a>(<span class="keywordtype">char</span> *ip_str, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *ip_val)
<a name="l00383"></a>00383 {
<a name="l00384"></a>00384   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num = 0, val;
<a name="l00385"></a>00385   <span class="keywordtype">char</span> *tok;
<a name="l00386"></a>00386   <span class="keywordtype">int</span> count = 0;
<a name="l00387"></a>00387   <span class="keywordtype">char</span> buf[16]; <span class="comment">/* Maximum length of IP address in dotten notation */</span>
<a name="l00388"></a>00388 
<a name="l00389"></a>00389   <span class="keywordflow">if</span>((ip_str == <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (ip_val == <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) || (strlen(ip_str) &gt; 16))
<a name="l00390"></a>00390   {
<a name="l00391"></a>00391     <span class="keywordflow">return</span> -1;
<a name="l00392"></a>00392   }
<a name="l00393"></a>00393   strcpy(buf, ip_str);
<a name="l00394"></a>00394   tok = strtok(buf, <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00395"></a>00395   <span class="keywordflow">while</span>(tok != <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)
<a name="l00396"></a>00396   {
<a name="l00397"></a>00397     count++;
<a name="l00398"></a>00398     val = atoi(tok);
<a name="l00399"></a>00399     <span class="keywordflow">if</span>((val &lt; 0) || (val &gt; 0xff))
<a name="l00400"></a>00400     {
<a name="l00401"></a>00401       <span class="keywordflow">return</span> -1;
<a name="l00402"></a>00402     }
<a name="l00403"></a>00403     num = (num &lt;&lt; 8) + val;
<a name="l00404"></a>00404     tok = strtok(<a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="stringliteral">&quot;.&quot;</span>);
<a name="l00405"></a>00405   }
<a name="l00406"></a>00406   <span class="keywordflow">if</span>(count != 4)
<a name="l00407"></a>00407   {
<a name="l00408"></a>00408     <span class="keywordflow">return</span> -1;
<a name="l00409"></a>00409   }
<a name="l00410"></a>00410   *ip_val = num;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keywordflow">return</span> 0;
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 <span class="comment">/**************************************************************************/</span>
<a name="l00425"></a><a class="code" href="util_8c.html#a8af6968664b72ffda55645d67cb908be">00425</a> <span class="keywordtype">void</span> <a class="code" href="examples_2util_8h.html#a8af6968664b72ffda55645d67cb908be" title="To print IP address in dotted decimal format.">print_ip_addr</a>(<span class="keywordtype">char</span> *str, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> host)
<a name="l00426"></a>00426 {
<a name="l00427"></a>00427   <span class="keywordtype">int</span> a,b,c,d;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429   a = (host &gt;&gt; 24) &amp; 0xff;
<a name="l00430"></a>00430   b = (host &gt;&gt; 16) &amp; 0xff;
<a name="l00431"></a>00431   c = (host &gt;&gt; 8 ) &amp; 0xff;
<a name="l00432"></a>00432   d = host &amp; 0xff;
<a name="l00433"></a>00433   printf(<span class="stringliteral">&quot;%s %d.%d.%d.%d&quot;</span>, str, a,b,c,d);
<a name="l00434"></a>00434 }
<a name="l00435"></a>00435 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="comment">/**************************************************************************/</span>
<a name="l00446"></a><a class="code" href="util_8c.html#a462b5d7ced1a3a5e35f45c6243d1b257">00446</a> <span class="keywordtype">int</span> <a class="code" href="util_8c.html#a462b5d7ced1a3a5e35f45c6243d1b257" title="To convert a C-style constant to integer.">opennsl_ctoi</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *s, <span class="keywordtype">char</span> **end)
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  n, neg;
<a name="l00449"></a>00449   <span class="keywordtype">int</span> base = 10;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451   <span class="keywordflow">if</span> (s == 0) {
<a name="l00452"></a>00452     <span class="keywordflow">if</span> (end != 0) {
<a name="l00453"></a>00453       end = 0;
<a name="l00454"></a>00454     }
<a name="l00455"></a>00455     <span class="keywordflow">return</span> 0;
<a name="l00456"></a>00456   }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458   s += (neg = (*s == <span class="charliteral">&#39;-&#39;</span>));
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;0&#39;</span>) {
<a name="l00461"></a>00461     s++;
<a name="l00462"></a>00462     <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;x&#39;</span> || *s == <span class="charliteral">&#39;X&#39;</span>) {
<a name="l00463"></a>00463       base = 16;
<a name="l00464"></a>00464       s++;
<a name="l00465"></a>00465     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;b&#39;</span> || *s == <span class="charliteral">&#39;B&#39;</span>) {
<a name="l00466"></a>00466       base = 2;
<a name="l00467"></a>00467       s++;
<a name="l00468"></a>00468     } <span class="keywordflow">else</span> {
<a name="l00469"></a>00469       base = 8;
<a name="l00470"></a>00470     }
<a name="l00471"></a>00471   }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473   <span class="keywordflow">for</span> (n = 0; ((*s &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; *s &lt; <span class="charliteral">&#39;a&#39;</span> + base - 10) ||
<a name="l00474"></a>00474         (*s &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; *s &lt; <span class="charliteral">&#39;A&#39;</span> + base - 10) ||
<a name="l00475"></a>00475         (*s &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *s &lt;= <span class="charliteral">&#39;9&#39;</span>)); s++) {
<a name="l00476"></a>00476     n = n * base + ((*s &lt;= <span class="charliteral">&#39;9&#39;</span> ? *s : *s + 9) &amp; 15);
<a name="l00477"></a>00477   }
<a name="l00478"></a>00478 
<a name="l00479"></a>00479   <span class="keywordflow">if</span> (end != 0) {
<a name="l00480"></a>00480     *end = (<span class="keywordtype">char</span> *) s;
<a name="l00481"></a>00481   }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483   <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) (neg ? -n : n);
<a name="l00484"></a>00484 }
<a name="l00485"></a>00485 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00486"></a>00486 
<a name="l00487"></a>00487 <span class="comment">/**************************************************************************/</span>
<a name="l00495"></a><a class="code" href="util_8c.html#a0ec5a9523868f063b9ebfe4cfc05cdb1">00495</a> <span class="keywordtype">int</span> <a class="code" href="examples_2util_8h.html#a0ec5a9523868f063b9ebfe4cfc05cdb1" title="To get the number of front panel ports.">example_max_port_count_get</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> *count)
<a name="l00496"></a>00496 {
<a name="l00497"></a>00497   <span class="keywordtype">int</span> rc;
<a name="l00498"></a>00498   <a class="code" href="structopennsl__port__config__s.html" title="Port Configuration structure.">opennsl_port_config_t</a> pcfg;
<a name="l00499"></a>00499   <span class="keywordtype">int</span> num_ports;
<a name="l00500"></a>00500   <span class="keywordtype">int</span> num_front_panel_ports;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502   rc = <a class="code" href="group__port.html#ga9f95e3f27b53970914dccc70ffbe7010" title="Retrieved the port configuration for the specified device.">opennsl_port_config_get</a>(unit, &amp;pcfg);
<a name="l00503"></a>00503   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00504"></a>00504     printf(<span class="stringliteral">&quot;Failed to get port configuration. Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00505"></a>00505     <span class="keywordflow">return</span> rc;
<a name="l00506"></a>00506   }
<a name="l00507"></a>00507 
<a name="l00508"></a>00508   <a class="code" href="group__types.html#gaced1b7d5db61f5d7d2262da91bdb6887">OPENNSL_PBMP_COUNT</a>(pcfg.<a class="code" href="structopennsl__port__config__s.html#a6a0d55ca5f29547cfcc5c3c1a6149e81" title="Mask of GE ports.">ge</a>, num_ports);
<a name="l00509"></a>00509   num_front_panel_ports = num_ports;
<a name="l00510"></a>00510   <a class="code" href="group__types.html#gaced1b7d5db61f5d7d2262da91bdb6887">OPENNSL_PBMP_COUNT</a>(pcfg.<a class="code" href="structopennsl__port__config__s.html#a796873998a7d8b698aa878cf51883ef8" title="Mask of 10gig ports.">xe</a>, num_ports);
<a name="l00511"></a>00511   num_front_panel_ports += num_ports;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513   *count = num_front_panel_ports;
<a name="l00514"></a>00514   <span class="keywordflow">return</span> rc;
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00517"></a>00517 
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->





</body>
</html>
