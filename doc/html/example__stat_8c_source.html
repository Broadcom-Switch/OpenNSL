<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/example_stat.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen/doxygen_brcm.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/example_stat.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="example__stat_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2017</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * \file         example_stat.c</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * \brief        OpenNSL example program for showing statistics</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * \details      OpenNSL example program for displaying and clearing statistics</span>
<a name="l00024"></a>00024 <span class="comment"> *               of a given interface.</span>
<a name="l00025"></a>00025 <span class="comment"> *               interface.</span>
<a name="l00026"></a>00026 <span class="comment"> *</span>
<a name="l00027"></a>00027 <span class="comment"> **********************************************************************/</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="stat_8h.html">opennsl/stat.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;<a class="code" href="stat_8h.html">opennsl/stat.h</a>&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="example__stat_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">00038</a> <span class="preprocessor">#define DEFAULT_UNIT 0</span>
<a name="l00039"></a><a class="code" href="example__stat_8c.html#a91668ed1245d073a2ac84e6121205d28">00039</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_VLAN 1</span>
<a name="l00040"></a><a class="code" href="example__stat_8c.html#ae561a2dab8025f585c77571f67d4771e">00040</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_COUNTERS 30</span>
<a name="l00041"></a><a class="code" href="example__stat_8c.html#a068278b0838b6670ab0ab0a93ed77484">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_DIGITS_IN_CHOICE 5</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>
<a name="l00043"></a><a class="code" href="example__stat_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">00043</a> <span class="keywordtype">char</span> <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =
<a name="l00044"></a>00044 <span class="stringliteral">&quot;Syntax: example_stat                                                  \n\r&quot;</span>
<a name="l00045"></a>00045 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00046"></a>00046 <span class="stringliteral">&quot;Paramaters: None                                                      \n\r&quot;</span>
<a name="l00047"></a>00047 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00048"></a>00048 <span class="stringliteral">&quot;Example: The following command is used to see the statistics of a port\n\r&quot;</span>
<a name="l00049"></a>00049 <span class="stringliteral">&quot;         example_stat                                                 \n\r&quot;</span>
<a name="l00050"></a>00050 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00051"></a>00051 <span class="stringliteral">&quot;Usage Guidelines: This program request the user to enter the port     \n\r&quot;</span>
<a name="l00052"></a>00052 <span class="stringliteral">&quot;                  number interactively                                \n\r&quot;</span>;
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="comment">/*****************************************************************/</span>
<a name="l00061"></a>00061 <span class="comment">/* Main function for Statistics application */</span>
<a name="l00062"></a><a class="code" href="example__stat_8c.html#a0ddf1224851353fc92bfbff6f499fa97">00062</a> <span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for policer application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064   <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a>   rc;
<a name="l00065"></a>00065   <span class="keywordtype">int</span> choice;
<a name="l00066"></a>00066   <span class="keywordtype">int</span> unit = <a class="code" href="example__stat_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;
<a name="l00067"></a>00067   <span class="keywordtype">int</span> i;
<a name="l00068"></a>00068   <span class="keywordtype">int</span> nstat;
<a name="l00069"></a>00069   <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00070"></a>00070   <a class="code" href="group__stat.html#ga477326d25d4844a3d50c67f0dad26577" title="Statistics counters.">opennsl_stat_val_t</a> stat_arr[] = {
<a name="l00071"></a>00071     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a382bdae0ec2af0ecd12e1ac850901ada" title="RFC 1213.">opennsl_spl_snmpIfInUcastPkts</a>,
<a name="l00072"></a>00072     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a8dc30b2ca9351c782643df38bd95c545" title="RFC 1213.">opennsl_spl_snmpIfInNUcastPkts</a>,
<a name="l00073"></a>00073     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a2a0fa0d1fc8c981993df3dad61d2dae2" title="RFC 1213.">opennsl_spl_snmpIfInDiscards</a>,
<a name="l00074"></a>00074     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ab8ee1e02af088f325ff4e9aaa0e52c0e" title="RFC 1213.">opennsl_spl_snmpIfInErrors</a>,
<a name="l00075"></a>00075     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a8f5fd87c48e5051f49153ed17a3a15f2" title="RFC 1573.">opennsl_spl_snmpIfInMulticastPkts</a>,
<a name="l00076"></a>00076     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a40f39a5abf156de543eab7d1b720bb42" title="RFC 1573.">opennsl_spl_snmpIfInBroadcastPkts</a>,
<a name="l00077"></a>00077     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ae798af3630fe8d826782cf0288bc9570" title="Broadcom-specific.">snmpOpenNSLReceivedPkts64Octets</a>,
<a name="l00078"></a>00078     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a89e7dc81feecc87f69f2da4ec4fab8e3" title="Broadcom-specific.">snmpOpenNSLReceivedPkts65to127Octets</a>,
<a name="l00079"></a>00079     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ad2abf714fe2f31eb54331b1cfeebeede" title="Broadcom-specific.">snmpOpenNSLReceivedPkts128to255Octets</a>,
<a name="l00080"></a>00080     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a261b08f270e068bbb467d22b798130e6" title="Broadcom-specific.">snmpOpenNSLReceivedPkts256to511Octets</a>,
<a name="l00081"></a>00081     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a12ae69470a0cfa8202b7f2b18d6ea945" title="Broadcom-specific.">snmpOpenNSLReceivedPkts512to1023Octets</a>,
<a name="l00082"></a>00082     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a3add1c8f6e556e87c40714fecddf4bc0" title="Broadcom-specific.">snmpOpenNSLReceivedPkts1024to1518Octets</a>,
<a name="l00083"></a>00083     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ab4de1b5eed77188c946a4068bec04901" title="Broadcom-specific.">snmpOpenNSLReceivedPkts1519to2047Octets</a>,
<a name="l00084"></a>00084     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60abed7ab9ee7716c821b7b4d44f023ba2f" title="Broadcom-specific.">snmpOpenNSLReceivedPkts2048to4095Octets</a>,
<a name="l00085"></a>00085     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60aa81d0f08567d7d9ed2872197a28ae008" title="Broadcom-specific.">snmpOpenNSLReceivedPkts4095to9216Octets</a>,
<a name="l00086"></a>00086     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a0fb4c2d054a1671094dd924bed11f203" title="RFC 1213.">opennsl_spl_snmpIfOutUcastPkts</a>,
<a name="l00087"></a>00087     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a65b2d250b908a6b6868a487fc869f78a" title="RFC 1213.">opennsl_spl_snmpIfOutNUcastPkts</a>,
<a name="l00088"></a>00088     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a37b7586eab6b79d7ca0b65fd46de2171" title="RFC 1213.">opennsl_spl_snmpIfOutDiscards</a>,
<a name="l00089"></a>00089     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a9b54d76c19b67f9f4ce3c9285be5fcb0" title="RFC 1213.">opennsl_spl_snmpIfOutErrors</a>,
<a name="l00090"></a>00090     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ac88897ee6dfc46d10452bcb56014f597" title="RFC 1573.">opennsl_spl_snmpIfOutMulticastPkts</a>,
<a name="l00091"></a>00091     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a81fcf41576ac28fcfb14cfee13570b35" title="RFC 1573.">opennsl_spl_snmpIfOutBroadcastPkts</a>,
<a name="l00092"></a>00092     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ae51467409fdc68b02ea5723dff177338" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts64Octets</a>,
<a name="l00093"></a>00093     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60aebd6e69c2e57056b58990cc2e1713ede" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts65to127Octets</a>,
<a name="l00094"></a>00094     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ad5dedadecfe7f07365a22d59fc28d7ab" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts128to255Octets</a>,
<a name="l00095"></a>00095     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a4c7059ddf9a3a5656046b37e0152c4c1" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts256to511Octets</a>,
<a name="l00096"></a>00096     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ad5450f437b03670d777c5fce850dde56" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts512to1023Octets</a>,
<a name="l00097"></a>00097     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ad189dc71fce191b5545fe1e931cbf38c" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts1024to1518Octets</a>,
<a name="l00098"></a>00098     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a18555bb78728442a48860096e3802e46" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts1519to2047Octets</a>,
<a name="l00099"></a>00099     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60ae12f0b1c930bb4222cabc6d6a07a0b55" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts2048to4095Octets</a>,
<a name="l00100"></a>00100     <a class="code" href="group__stat.html#gga2a18773cde876343fca0b2ae797f9d60a08409288a8b24954d010a35c4f401978" title="Broadcom-specific.">snmpOpenNSLTransmittedPkts4095to9216Octets</a>,};
<a name="l00101"></a>00101   <a class="code" href="sal_2types_8h.html#aa3ad64cf41ec3a042bd92550cc6ed308">uint64</a> val[<a class="code" href="example__stat_8c.html#ae561a2dab8025f585c77571f67d4771e">MAX_COUNTERS</a>] = {0};
<a name="l00102"></a>00102 
<a name="l00103"></a>00103   nstat = (<span class="keyword">sizeof</span>(stat_arr) / <span class="keyword">sizeof</span>(<a class="code" href="group__stat.html#ga477326d25d4844a3d50c67f0dad26577" title="Statistics counters.">opennsl_stat_val_t</a>));
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="keywordflow">if</span>((argc != 1) || ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) {
<a name="l00106"></a>00106     printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);
<a name="l00107"></a>00107     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00108"></a>00108   }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110   <span class="comment">/* Initialize the system. */</span>
<a name="l00111"></a>00111   printf(<span class="stringliteral">&quot;Initializing the system.\r\n&quot;</span>);
<a name="l00112"></a>00112   rc = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114   <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00115"></a>00115     printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system, rc = %d (%s).\r\n&quot;</span>,
<a name="l00116"></a>00116            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00117"></a>00117     <span class="keywordflow">return</span> 0;
<a name="l00118"></a>00118   }
<a name="l00119"></a>00119 
<a name="l00120"></a>00120   <span class="comment">/* cold boot initialization commands */</span>
<a name="l00121"></a>00121   rc = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);
<a name="l00122"></a>00122   <span class="keywordflow">if</span> (rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00123"></a>00123     printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00124"></a>00124            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00125"></a>00125   }
<a name="l00126"></a>00126 
<a name="l00127"></a>00127   <span class="comment">/* Add ports to default vlan. */</span>
<a name="l00128"></a>00128   printf(<span class="stringliteral">&quot;Adding ports to default vlan.\r\n&quot;</span>);
<a name="l00129"></a>00129   rc = <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(unit);
<a name="l00130"></a>00130   <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00131"></a>00131     printf(<span class="stringliteral">&quot;\r\nFailed to add default ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00132"></a>00132            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00133"></a>00133   }
<a name="l00134"></a>00134 
<a name="l00135"></a>00135   <span class="comment">/* Initialize stat module. */</span>
<a name="l00136"></a>00136   printf(<span class="stringliteral">&quot;Initializing the stat module.\r\n&quot;</span>);
<a name="l00137"></a>00137   rc = <a class="code" href="group__stat.html#gae16d66ca83bbe4770b5f1e70f5442099" title="Initialize the OPENNSL statistics module.">opennsl_stat_init</a>(unit);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139   <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00140"></a>00140     printf(<span class="stringliteral">&quot;\r\nFailed to initialise stat module, rc = %d (%s).\r\n&quot;</span>,
<a name="l00141"></a>00141            rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00142"></a>00142     <span class="keywordflow">return</span> 0;
<a name="l00143"></a>00143   }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 
<a name="l00146"></a>00146   <span class="keywordflow">while</span> (1) {
<a name="l00147"></a>00147     printf(<span class="stringliteral">&quot;\nUser Menu: Select one of the following options\n&quot;</span>);
<a name="l00148"></a>00148     printf(<span class="stringliteral">&quot;1. Display statistics of a port.\n&quot;</span>);
<a name="l00149"></a>00149     printf(<span class="stringliteral">&quot;2. Clear statistics of a port.\n&quot;</span>);
<a name="l00150"></a>00150 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00151"></a>00151 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);
<a name="l00152"></a>00152 <span class="preprocessor">#endif</span>
<a name="l00153"></a>00153 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application.\n&quot;</span>);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00158"></a>00158         <span class="keywordflow">continue</span>;
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160     <span class="keywordflow">switch</span>(choice) {
<a name="l00161"></a>00161 
<a name="l00162"></a>00162       <span class="keywordflow">case</span> 1:
<a name="l00163"></a>00163       {
<a name="l00164"></a>00164         printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00165"></a>00165         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00166"></a>00166         {
<a name="l00167"></a>00167             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00168"></a>00168             <span class="keywordflow">continue</span>;
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170         rc = (<a class="code" href="group__stat.html#gabd03e9b669f1833cb21ea97472afc0b2" title="Synchronize software counters with hardware.">opennsl_stat_sync</a>(unit));
<a name="l00171"></a>00171         <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00172"></a>00172           printf(<span class="stringliteral">&quot;\r\nFailed to sync the state of port, rc = %d (%s).\r\n&quot;</span>,
<a name="l00173"></a>00173                  rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00174"></a>00174           <span class="keywordflow">break</span>;
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         rc = <a class="code" href="group__stat.html#ga09bf081d74a2182e6005405f80815931" title="Get the specified statistics from the device.">opennsl_stat_multi_get</a>(unit, port, nstat, stat_arr, val);
<a name="l00178"></a>00178  
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (rc == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a006d3a00f98cb2a8e177bf1766a7789b">OPENNSL_E_UNAVAIL</a>) {
<a name="l00180"></a>00180            <span class="keywordflow">for</span> (i=0; i &lt; nstat; i++) {
<a name="l00181"></a>00181               rc = <a class="code" href="group__stat.html#ga235bf08eb34a32bf77832d7c1c187768" title="Get the specified statistics from the device.">opennsl_stat_get</a>(unit, port, stat_arr[i], &amp;val[i]);
<a name="l00182"></a>00182            }          
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00186"></a>00186           printf(<span class="stringliteral">&quot;\r\nFailed to get the port stats, rc = %d (%s).\r\n&quot;</span>,
<a name="l00187"></a>00187                  rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00188"></a>00188           <span class="keywordflow">break</span>;
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         printf(<span class="stringliteral">&quot;Count of Ingress Unicast packets    .......   %llu\n&quot;</span>, val[0]);
<a name="l00192"></a>00192         printf(<span class="stringliteral">&quot;Count of Ingress Non-unicast packets.......   %llu\n&quot;</span>, val[1]);
<a name="l00193"></a>00193         printf(<span class="stringliteral">&quot;Count of Ingress Discard packets    .......   %llu\n&quot;</span>, val[2]);
<a name="l00194"></a>00194         printf(<span class="stringliteral">&quot;Count of Ingress Error packets      .......   %llu\n&quot;</span>, val[3]);
<a name="l00195"></a>00195         printf(<span class="stringliteral">&quot;Count of Ingress Multicast packets  .......   %llu\n&quot;</span>, val[4]);
<a name="l00196"></a>00196         printf(<span class="stringliteral">&quot;Count of Ingress Broadcast packets  .......   %llu\n&quot;</span>, val[5]);
<a name="l00197"></a>00197         printf(<span class="stringliteral">&quot;Count of Received 64 octets         .......   %llu\n&quot;</span>, val[6]);
<a name="l00198"></a>00198         printf(<span class="stringliteral">&quot;Count of Received 65-127 octets     .......   %llu\n&quot;</span>, val[7]);
<a name="l00199"></a>00199         printf(<span class="stringliteral">&quot;Count of Received 128-255 octets    .......   %llu\n&quot;</span>, val[8]);
<a name="l00200"></a>00200         printf(<span class="stringliteral">&quot;Count of Received 256-511 octets    .......   %llu\n&quot;</span>, val[9]);
<a name="l00201"></a>00201         printf(<span class="stringliteral">&quot;Count of Received 512-1023 octets   .......   %llu\n&quot;</span>, val[10]);
<a name="l00202"></a>00202         printf(<span class="stringliteral">&quot;Count of Received 1024-1518 octets  .......   %llu\n&quot;</span>, val[11]);
<a name="l00203"></a>00203         printf(<span class="stringliteral">&quot;Count of Received 1519-2047 octets  .......   %llu\n&quot;</span>, val[12]);
<a name="l00204"></a>00204         printf(<span class="stringliteral">&quot;Count of Received 2048-4095 octets  .......   %llu\n&quot;</span>, val[13]);
<a name="l00205"></a>00205         printf(<span class="stringliteral">&quot;Count of Received 4096-9216 octets  .......   %llu\n&quot;</span>, val[14]);
<a name="l00206"></a>00206         printf(<span class="stringliteral">&quot;Count of Egress Unicast packets     .......   %llu\n&quot;</span>, val[15]);
<a name="l00207"></a>00207         printf(<span class="stringliteral">&quot;Count of Egress Non-unicast packets .......   %llu\n&quot;</span>, val[16]);
<a name="l00208"></a>00208         printf(<span class="stringliteral">&quot;Count of Egress Discards packets    .......   %llu\n&quot;</span>, val[17]);
<a name="l00209"></a>00209         printf(<span class="stringliteral">&quot;Count of Egress Error packets       .......   %llu\n&quot;</span>, val[18]);
<a name="l00210"></a>00210         printf(<span class="stringliteral">&quot;Count of Egress Multicast packets   .......   %llu\n&quot;</span>, val[19]);
<a name="l00211"></a>00211         printf(<span class="stringliteral">&quot;Count of Egress Broadcast packets   .......   %llu\n&quot;</span>, val[20]);
<a name="l00212"></a>00212         printf(<span class="stringliteral">&quot;Count of Transmitted 64 octets      .......   %llu\n&quot;</span>, val[21]);
<a name="l00213"></a>00213         printf(<span class="stringliteral">&quot;Count of Transmitted 65-127 octets  .......   %llu\n&quot;</span>, val[22]);
<a name="l00214"></a>00214         printf(<span class="stringliteral">&quot;Count of Transmitted 128-255 octets .......   %llu\n&quot;</span>, val[23]);
<a name="l00215"></a>00215         printf(<span class="stringliteral">&quot;Count of Transmitted 256-511 octets .......   %llu\n&quot;</span>, val[24]);
<a name="l00216"></a>00216         printf(<span class="stringliteral">&quot;Count of Transmitted 512-1023 octet .......   %llu\n&quot;</span>, val[25]);
<a name="l00217"></a>00217         printf(<span class="stringliteral">&quot;Count of Transmitted 1024-1518 octets .....   %llu\n&quot;</span>, val[26]);
<a name="l00218"></a>00218         printf(<span class="stringliteral">&quot;Count of Transmitted 1519-2047 octets .....   %llu\n&quot;</span>, val[27]);
<a name="l00219"></a>00219         printf(<span class="stringliteral">&quot;Count of Transmitted 2048-4095 octets .....   %llu\n&quot;</span>, val[28]);
<a name="l00220"></a>00220         <span class="keywordflow">break</span>;
<a name="l00221"></a>00221       } <span class="comment">/* End of case 1 */</span>
<a name="l00222"></a>00222 
<a name="l00223"></a>00223       <span class="keywordflow">case</span> 2:
<a name="l00224"></a>00224       {
<a name="l00225"></a>00225         printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00226"></a>00226         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00227"></a>00227         {
<a name="l00228"></a>00228             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00229"></a>00229             <span class="keywordflow">continue</span>;
<a name="l00230"></a>00230         }
<a name="l00231"></a>00231         rc = <a class="code" href="group__stat.html#gab7c327864be73ebe3606f7cee994f2e1" title="Clear the port-based statistics for the indicated device port.">opennsl_stat_clear</a>(unit, port);
<a name="l00232"></a>00232         <span class="keywordflow">if</span>(rc != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00233"></a>00233           printf(<span class="stringliteral">&quot;\r\nFailed to clear the port stats, rc = %d (%s).\r\n&quot;</span>,
<a name="l00234"></a>00234                  rc, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rc));
<a name="l00235"></a>00235           <span class="keywordflow">break</span>;
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238         printf(<span class="stringliteral">&quot;\r\nPort %d stats cleared\r\n&quot;</span>, port);
<a name="l00239"></a>00239         <span class="keywordflow">break</span>;
<a name="l00240"></a>00240       } <span class="comment">/* End of case 2 */</span>
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00243"></a>00243 <span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:
<a name="l00244"></a>00244       {
<a name="l00245"></a>00245         opennsl_driver_shell();
<a name="l00246"></a>00246         <span class="keywordflow">break</span>;
<a name="l00247"></a>00247       }
<a name="l00248"></a>00248 <span class="preprocessor">#endif</span>
<a name="l00249"></a>00249 <span class="preprocessor"></span>
<a name="l00250"></a>00250       <span class="keywordflow">case</span> 0:
<a name="l00251"></a>00251       {
<a name="l00252"></a>00252         printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);
<a name="l00253"></a>00253         rc = <a class="code" href="driver_8h.html#aa760e8f1af45c7fd27ec014b82c572f2" title="Function to free up the resources and exit the driver.">opennsl_driver_exit</a>();
<a name="l00254"></a>00254         <span class="keywordflow">return</span> rc;
<a name="l00255"></a>00255       }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257       <span class="keywordflow">default</span> :
<a name="l00258"></a>00258         <span class="keywordflow">break</span>;
<a name="l00259"></a>00259     } <span class="comment">/* End of switch */</span>
<a name="l00260"></a>00260   } <span class="comment">/* End of while */</span>
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <span class="keywordflow">return</span> 0;
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00265"></a>00265 
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->





</body>
</html>
