<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/example_trunk.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen/doxygen_brcm.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/example_trunk.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="example__trunk_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2017</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> * \file     example_trunk.c</span>
<a name="l00019"></a>00019 <span class="comment"> *</span>
<a name="l00020"></a>00020 <span class="comment"> * \brief    Example code for Trunk application</span>
<a name="l00021"></a>00021 <span class="comment"> *</span>
<a name="l00022"></a>00022 <span class="comment"> * \details  This example demonstrates a simple trunk API scenario.</span>
<a name="l00023"></a>00023 <span class="comment"> *</span>
<a name="l00024"></a>00024 <span class="comment"> * This application also supports Warmboot feature. Warmboot is the</span>
<a name="l00025"></a>00025 <span class="comment"> * process of restarting the device driver software while the hardware is</span>
<a name="l00026"></a>00026 <span class="comment"> * running without interrupting the dataplane.</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * Setup the following envinonment variable before running the application.</span>
<a name="l00029"></a>00029 <span class="comment"> * For Cold boot mode, use &quot;export OPENNSL_BOOT_FLAGS = 0x000000&quot;.</span>
<a name="l00030"></a>00030 <span class="comment"> * For Warm boot mode, use &quot;export OPENNSL_BOOT_FLAGS = 0x200000&quot;.</span>
<a name="l00031"></a>00031 <span class="comment"> *</span>
<a name="l00032"></a>00032 <span class="comment"> ************************************************************************/</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;<a class="code" href="driver_8h.html">sal/driver.h</a>&gt;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2port_8h.html">opennsl/port.h</a>&gt;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2switch_8h.html">opennsl/switch.h</a>&gt;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &lt;<a class="code" href="trunk_8h.html">opennsl/trunk.h</a>&gt;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="example__trunk_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">00045</a> <span class="preprocessor">#define DEFAULT_UNIT  0</span>
<a name="l00046"></a><a class="code" href="example__trunk_8c.html#a91668ed1245d073a2ac84e6121205d28">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_VLAN  1</span>
<a name="l00047"></a><a class="code" href="example__trunk_8c.html#a068278b0838b6670ab0ab0a93ed77484">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_DIGITS_IN_CHOICE 5</span>
<a name="l00048"></a><a class="code" href="example__trunk_8c.html#a91e0509583edd821273f5b55995f6ad9">00048</a> <span class="preprocessor"></span><span class="preprocessor">#define MAX_TRUNK_MEMBER 8</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a><a class="code" href="example__trunk_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">00050</a> <span class="keywordtype">char</span> <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =
<a name="l00051"></a>00051 <span class="stringliteral">&quot;Syntax: example_trunk                                                 \n\r&quot;</span>
<a name="l00052"></a>00052 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00053"></a>00053 <span class="stringliteral">&quot;Paramaters: None.                                                     \n\r&quot;</span>
<a name="l00054"></a>00054 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00055"></a>00055 <span class="stringliteral">&quot;Example: The following command is used to demonstrate trunk API       \n\r&quot;</span>
<a name="l00056"></a>00056 <span class="stringliteral">&quot;calls. The interactive user interface allows the user to get          \n\r&quot;</span>
<a name="l00057"></a>00057 <span class="stringliteral">&quot;the trunk information, add, delete ports and destroy a trunk.         \n\r&quot;</span>
<a name="l00058"></a>00058 <span class="stringliteral">&quot;         example_trunk                                                \n\r&quot;</span>
<a name="l00059"></a>00059 <span class="stringliteral">&quot;                                                                      \n\r&quot;</span>
<a name="l00060"></a>00060 <span class="stringliteral">&quot;Usage Guidelines: None.                                               \n\r&quot;</span>;
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="comment">/*****************************************************************/</span>
<a name="l00072"></a><a class="code" href="example__trunk_8c.html#a6362d4b46ba9ad62d8f19ce3d0f17fa5">00072</a> <span class="keywordtype">int</span> <a class="code" href="example__trunk_8c.html#a6362d4b46ba9ad62d8f19ce3d0f17fa5" title="Create a default trunk.">example_trunk_create</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gab4a7b5b8761421414b682166c368249c" title="opennsl_trunk_t">opennsl_trunk_t</a> *tid)
<a name="l00073"></a>00073 {
<a name="l00074"></a>00074   <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a> rv;
<a name="l00075"></a>00075 
<a name="l00076"></a>00076   rv = <a class="code" href="group__trunk.html#ga7df50e21d88537766cca3b4685bbccc2" title="Create the software data structure for a new trunk, using caller-specified or next available trunk ID...">opennsl_trunk_create</a>(unit, 0, tid);
<a name="l00077"></a>00077   <span class="keywordflow">return</span> rv;
<a name="l00078"></a>00078 }
<a name="l00079"></a>00079 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="comment">/*****************************************************************/</span>
<a name="l00088"></a><a class="code" href="example__trunk_8c.html#a25b9ce34f37c7eda6e3e4825d133f33f">00088</a> <span class="keywordtype">int</span> <a class="code" href="example__trunk_8c.html#a25b9ce34f37c7eda6e3e4825d133f33f" title="Set hash controls.">example_trunk_hash_controls_set</a>(<span class="keywordtype">int</span> unit)
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090   <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00091"></a>00091   <span class="keywordtype">int</span> hashControl = 0;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093   <span class="comment">/* Set the ECMP hashControl to include dstip also - for XGS3 only */</span>
<a name="l00094"></a>00094   <a class="code" href="group__error.html#gaa1ed0c76c2846d4d337b3157ff73c823">OPENNSL_IF_ERROR_RETURN</a>(<a class="code" href="group__switch.html#ga9ede5092b4f00443b43bc7e2564427fb" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_get</a>(unit,
<a name="l00095"></a>00095         <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca36d01604ce348590374aa21ed604e737" title="Hash Control of fields.">opennslSwitchHashControl</a>, &amp;hashControl));
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="comment">/* Set the L2 hash controls first. */</span>
<a name="l00098"></a>00098   hashControl |= (<a class="code" href="group__switch.html#ga22c7ae8b92c081cfc7037c4569d00144" title="Use destination MAC or IP address.">OPENNSL_HASH_CONTROL_TRUNK_NUC_DST</a>
<a name="l00099"></a>00099       | <a class="code" href="group__switch.html#ga6d2c7fe13ba549ddf1ac99d2fa9ac881" title="Use source MAC or IP address.">OPENNSL_HASH_CONTROL_TRUNK_NUC_SRC</a>
<a name="l00100"></a>00100       | <a class="code" href="group__switch.html#ga0d02afa667a07e9c6caa13989331a0d1" title="Use source port.">OPENNSL_HASH_CONTROL_TRUNK_UC_SRCPORT</a>);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102   <a class="code" href="group__error.html#gaa1ed0c76c2846d4d337b3157ff73c823">OPENNSL_IF_ERROR_RETURN</a>(<a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit,
<a name="l00103"></a>00103         <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca36d01604ce348590374aa21ed604e737" title="Hash Control of fields.">opennslSwitchHashControl</a>, hashControl));
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="comment">/* Set the L3 hash controls next. */</span>
<a name="l00106"></a>00106   <span class="comment">/* L4 ports hashControl below is valid for ECMP as well as regular UC</span>
<a name="l00107"></a>00107 <span class="comment">   * trunk load balacing</span>
<a name="l00108"></a>00108 <span class="comment">   */</span>
<a name="l00109"></a>00109   hashControl |=  (<a class="code" href="group__switch.html#ga1784b83fecc2ce75dae6491e23021bca" title="Use TCP/UDP ports.">OPENNSL_HASH_CONTROL_MULTIPATH_L4PORTS</a>
<a name="l00110"></a>00110       | <a class="code" href="group__switch.html#ga5a76632eb95c98172f8b569472a5a8f0" title="Use destination IP address.">OPENNSL_HASH_CONTROL_MULTIPATH_DIP</a>);
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <a class="code" href="group__error.html#gaa1ed0c76c2846d4d337b3157ff73c823">OPENNSL_IF_ERROR_RETURN</a>(<a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(unit,
<a name="l00113"></a>00113         <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca36d01604ce348590374aa21ed604e737" title="Hash Control of fields.">opennslSwitchHashControl</a>, hashControl));
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <span class="keywordflow">return</span> rv;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="comment">/*****************************************************************/</span>
<a name="l00126"></a><a class="code" href="example__trunk_8c.html#a0ddf1224851353fc92bfbff6f499fa97">00126</a> <span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for policer application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00127"></a>00127 {
<a name="l00128"></a>00128   <a class="code" href="group__error.html#gac798c5c818a3213c27d2900d47add7f9" title="OPENNSL API error codes.">opennsl_error_t</a>   rv;
<a name="l00129"></a>00129   <a class="code" href="group__types.html#gab4a7b5b8761421414b682166c368249c" title="opennsl_trunk_t">opennsl_trunk_t</a> tid;
<a name="l00130"></a>00130   <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> gport;
<a name="l00131"></a>00131   <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>;
<a name="l00132"></a>00132   <span class="keywordtype">int</span> unit = <a class="code" href="example__trunk_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;
<a name="l00133"></a>00133   <span class="keywordtype">int</span> member_max = <a class="code" href="example__trunk_8c.html#a91e0509583edd821273f5b55995f6ad9">MAX_TRUNK_MEMBER</a>, member_count, i;
<a name="l00134"></a>00134   <a class="code" href="structopennsl__trunk__member__s.html" title="Structure describing a trunk member.">opennsl_trunk_member_t</a> member;
<a name="l00135"></a>00135   <a class="code" href="structopennsl__trunk__member__s.html" title="Structure describing a trunk member.">opennsl_trunk_member_t</a> member_arr[member_max];
<a name="l00136"></a>00136   <a class="code" href="structopennsl__trunk__info__s.html" title="Trunk group attributes structure.">opennsl_trunk_info_t</a> t_data;
<a name="l00137"></a>00137   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> warm_boot;
<a name="l00138"></a>00138   <span class="keywordtype">int</span> choice;
<a name="l00139"></a>00139   <span class="keywordtype">int</span> index = 0;
<a name="l00140"></a>00140   <span class="keywordtype">int</span> psc = 0;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142   <span class="keywordflow">if</span>(strcmp(argv[0], <span class="stringliteral">&quot;gdb&quot;</span>) == 0)
<a name="l00143"></a>00143   {
<a name="l00144"></a>00144     index = 1;
<a name="l00145"></a>00145   }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147   <span class="keywordflow">if</span>((argc != (index + 1)) || ((argc &gt; (index + 1)) &amp;&amp; (strcmp(argv[index + 1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) {
<a name="l00148"></a>00148     printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);
<a name="l00149"></a>00149     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00150"></a>00150   }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="comment">/* Initialize the system. */</span>
<a name="l00153"></a>00153   printf(<span class="stringliteral">&quot;Initializing the system.\r\n&quot;</span>);
<a name="l00154"></a>00154   rv = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00157"></a>00157     printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system. Error %s\r\n&quot;</span>,
<a name="l00158"></a>00158         <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00159"></a>00159     <span class="keywordflow">return</span> rv;
<a name="l00160"></a>00160   }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162   warm_boot = <a class="code" href="driver_8h.html#a6c710a947a607aec06058230e9558fea" title="To get platform boot flags.">opennsl_driver_boot_flags_get</a>() &amp; <a class="code" href="examples_2util_8h.html#aa6fc4fddb8d12deb70b0401eba5b8c54">OPENNSL_BOOT_F_WARM_BOOT</a>;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="keywordflow">if</span>(!warm_boot)
<a name="l00165"></a>00165   {
<a name="l00166"></a>00166    <span class="comment">/* cold boot initialization commands */</span>
<a name="l00167"></a>00167     rv = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00169"></a>00169     {
<a name="l00170"></a>00170       printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00171"></a>00171              rv, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00172"></a>00172     }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="comment">/* Add ports to default vlan. */</span>
<a name="l00175"></a>00175     printf(<span class="stringliteral">&quot;Adding ports to default vlan.\r\n&quot;</span>);
<a name="l00176"></a>00176     rv = <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(unit);
<a name="l00177"></a>00177     <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00178"></a>00178     {
<a name="l00179"></a>00179       printf(<span class="stringliteral">&quot;\r\nFailed to add default ports. rv: %s\r\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00180"></a>00180       <span class="keywordflow">return</span> rv;
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183     printf(<span class="stringliteral">&quot;Setting Hash controls for Trunk.\r\n&quot;</span>);
<a name="l00184"></a>00184     rv = <a class="code" href="example__trunk_8c.html#a25b9ce34f37c7eda6e3e4825d133f33f" title="Set hash controls.">example_trunk_hash_controls_set</a>(unit);
<a name="l00185"></a>00185     <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187       printf(<span class="stringliteral">&quot;\r\nFailed to hash control for Trunk. Error %s\r\n&quot;</span>,
<a name="l00188"></a>00188           <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190   }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="keywordflow">while</span> (1) {
<a name="l00193"></a>00193     printf(<span class="stringliteral">&quot;\r\nUser menu: Select one of the following options\r\n&quot;</span>);
<a name="l00194"></a>00194     printf(<span class="stringliteral">&quot;1. Create trunk\n&quot;</span>);
<a name="l00195"></a>00195     printf(<span class="stringliteral">&quot;2. Add port to trunk\n&quot;</span>);
<a name="l00196"></a>00196     printf(<span class="stringliteral">&quot;3. Delete port from trunk\n&quot;</span>);
<a name="l00197"></a>00197     printf(<span class="stringliteral">&quot;4. Get trunk info\n&quot;</span>);
<a name="l00198"></a>00198     printf(<span class="stringliteral">&quot;5. Delete trunk\n&quot;</span>);
<a name="l00199"></a>00199     printf(<span class="stringliteral">&quot;6. Save the configuration to scache\n&quot;</span>);
<a name="l00200"></a>00200     printf(<span class="stringliteral">&quot;7. Set port selection criteria (PSC)\n&quot;</span>);
<a name="l00201"></a>00201 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00202"></a>00202 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);
<a name="l00203"></a>00203 <span class="preprocessor">#endif</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application\n&quot;</span>);
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00207"></a>00207     {
<a name="l00208"></a>00208         printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00209"></a>00209         <span class="keywordflow">continue</span>;
<a name="l00210"></a>00210     }
<a name="l00211"></a>00211     <span class="keywordflow">switch</span>(choice){
<a name="l00212"></a>00212 
<a name="l00213"></a>00213       <span class="keywordflow">case</span> 1:
<a name="l00214"></a>00214       {
<a name="l00215"></a>00215         <span class="comment">/* Create default trunk */</span>
<a name="l00216"></a>00216         rv = <a class="code" href="example__trunk_8c.html#a6362d4b46ba9ad62d8f19ce3d0f17fa5" title="Create a default trunk.">example_trunk_create</a>(unit, &amp;tid);
<a name="l00217"></a>00217         <span class="keywordflow">if</span> (rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00218"></a>00218           printf(<span class="stringliteral">&quot;Trunk %d created successfully\n&quot;</span>, tid);
<a name="l00219"></a>00219         } <span class="keywordflow">else</span> {
<a name="l00220"></a>00220           printf(<span class="stringliteral">&quot;Failed to create trunk. Error %s\n&quot;</span>,
<a name="l00221"></a>00221                  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00222"></a>00222           <span class="keywordflow">continue</span>;
<a name="l00223"></a>00223         }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225         <span class="keywordflow">break</span>;
<a name="l00226"></a>00226       } <span class="comment">/* End of case 1 */</span>
<a name="l00227"></a>00227 
<a name="l00228"></a>00228       <span class="keywordflow">case</span> 2:
<a name="l00229"></a>00229       {
<a name="l00230"></a>00230         <span class="comment">/* Add port to trunk*/</span>
<a name="l00231"></a>00231         printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00232"></a>00232         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00233"></a>00233         {
<a name="l00234"></a>00234             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00235"></a>00235             <span class="keywordflow">continue</span>;
<a name="l00236"></a>00236         }
<a name="l00237"></a>00237         rv = <a class="code" href="group__port.html#gac3b1ddc83dbed38868b5ba256d29cdf7" title="Get the GPORT ID for the specified local port number.">opennsl_port_gport_get</a> (unit, port, &amp;gport);
<a name="l00238"></a>00238         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00239"></a>00239         {
<a name="l00240"></a>00240           <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00241"></a>00241         }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243         <a class="code" href="group__trunk.html#ga87e4d89541bb9b5518036f3966b5852f" title="Initializes the opennsl_trunk_member_t structure.">opennsl_trunk_member_t_init</a>(&amp;member);
<a name="l00244"></a>00244         member.<a class="code" href="structopennsl__trunk__member__s.html#ab120657b9b67892b6af3649136e61999" title="Trunk member GPORT ID.">gport</a> = gport;
<a name="l00245"></a>00245 
<a name="l00246"></a>00246         printf(<span class="stringliteral">&quot;\r\nEnter the trunk id.\r\n&quot;</span>);
<a name="l00247"></a>00247         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;tid) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00248"></a>00248         {
<a name="l00249"></a>00249             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00250"></a>00250             <span class="keywordflow">continue</span>;
<a name="l00251"></a>00251         }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253         printf(<span class="stringliteral">&quot;member_add: Adding port %d to trunk-id %d\n&quot;</span>, port, tid);
<a name="l00254"></a>00254         rv = <a class="code" href="group__trunk.html#ga52b40f164d20e1045731d8bb3b4057c5" title="Add a member to a trunk group.">opennsl_trunk_member_add</a>(unit, tid, &amp;member);
<a name="l00255"></a>00255         <span class="keywordflow">if</span> ((rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)) {
<a name="l00256"></a>00256           printf(<span class="stringliteral">&quot;Port %d added successfully to trunk %d\n&quot;</span>, port, tid);
<a name="l00257"></a>00257         } <span class="keywordflow">else</span> {
<a name="l00258"></a>00258           printf(<span class="stringliteral">&quot;Failed to add port. Error %s\n&quot;</span>,
<a name="l00259"></a>00259                  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00260"></a>00260           <span class="keywordflow">continue</span>;
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="keywordflow">break</span>;
<a name="l00264"></a>00264       } <span class="comment">/* End of case 2 */</span>
<a name="l00265"></a>00265 
<a name="l00266"></a>00266       <span class="keywordflow">case</span> 3:
<a name="l00267"></a>00267       {
<a name="l00268"></a>00268         <span class="comment">/* Delete port from trunk*/</span>
<a name="l00269"></a>00269         printf(<span class="stringliteral">&quot;\r\nEnter the port number.\r\n&quot;</span>);
<a name="l00270"></a>00270         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;port) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00271"></a>00271         {
<a name="l00272"></a>00272             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00273"></a>00273             <span class="keywordflow">continue</span>;
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275         rv = <a class="code" href="group__port.html#gac3b1ddc83dbed38868b5ba256d29cdf7" title="Get the GPORT ID for the specified local port number.">opennsl_port_gport_get</a> (unit, port, &amp;gport);
<a name="l00276"></a>00276         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00277"></a>00277         {
<a name="l00278"></a>00278           <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5acc22c36dedd5356dfbbf50d38397cca5">OPENNSL_E_FAIL</a>;
<a name="l00279"></a>00279         }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <a class="code" href="group__trunk.html#ga87e4d89541bb9b5518036f3966b5852f" title="Initializes the opennsl_trunk_member_t structure.">opennsl_trunk_member_t_init</a>(&amp;member);
<a name="l00282"></a>00282         member.<a class="code" href="structopennsl__trunk__member__s.html#ab120657b9b67892b6af3649136e61999" title="Trunk member GPORT ID.">gport</a> = gport;
<a name="l00283"></a>00283 
<a name="l00284"></a>00284         printf(<span class="stringliteral">&quot;\r\nEnter the trunk id.\r\n&quot;</span>);
<a name="l00285"></a>00285         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;tid) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00286"></a>00286         {
<a name="l00287"></a>00287             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00288"></a>00288             <span class="keywordflow">continue</span>;
<a name="l00289"></a>00289         }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291         printf(<span class="stringliteral">&quot;member_delete: Deleting port %d from trunk-id %d\n&quot;</span>, port, tid);
<a name="l00292"></a>00292         rv = <a class="code" href="group__trunk.html#ga7b24c94abfc15b0560ea216f40d1b825" title="Delete a member from a trunk group.">opennsl_trunk_member_delete</a>(unit, tid, &amp;member);
<a name="l00293"></a>00293         <span class="keywordflow">if</span> ((rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)) {
<a name="l00294"></a>00294           printf(<span class="stringliteral">&quot;Port %d deleted successfully from trunk %d\n&quot;</span>, port, tid);
<a name="l00295"></a>00295         } <span class="keywordflow">else</span> {
<a name="l00296"></a>00296           printf(<span class="stringliteral">&quot;Failed to delete port. Error %s\n&quot;</span>,
<a name="l00297"></a>00297                  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00298"></a>00298           <span class="keywordflow">continue</span>;
<a name="l00299"></a>00299         }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301         <span class="keywordflow">break</span>;
<a name="l00302"></a>00302       } <span class="comment">/* End of case 3 */</span>
<a name="l00303"></a>00303 
<a name="l00304"></a>00304       <span class="keywordflow">case</span> 4:
<a name="l00305"></a>00305       {
<a name="l00306"></a>00306         <span class="comment">/* Get trunk info*/</span>
<a name="l00307"></a>00307         printf(<span class="stringliteral">&quot;\r\nEnter the trunk id.\r\n&quot;</span>);
<a name="l00308"></a>00308         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;tid) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00309"></a>00309         {
<a name="l00310"></a>00310             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00311"></a>00311             <span class="keywordflow">continue</span>;
<a name="l00312"></a>00312         }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314         <span class="keywordflow">for</span> (i = 0; i &lt; member_max; i++)
<a name="l00315"></a>00315         {
<a name="l00316"></a>00316           <a class="code" href="group__trunk.html#ga87e4d89541bb9b5518036f3966b5852f" title="Initializes the opennsl_trunk_member_t structure.">opennsl_trunk_member_t_init</a>(&amp;member_arr[i]);
<a name="l00317"></a>00317         }
<a name="l00318"></a>00318         <a class="code" href="group__trunk.html#ga524c0657fa407ee8f88f0d3348ec29ca" title="Initializes the opennsl_trunk_info_t structure.">opennsl_trunk_info_t_init</a>(&amp;t_data);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         rv = <a class="code" href="group__trunk.html#gad70b2a084c22f09c61cd19715d77faf2" title="Get the current attributes and member ports for the specified trunk group.">opennsl_trunk_get</a>(unit, tid, &amp;t_data, member_max,
<a name="l00321"></a>00321             member_arr, &amp;member_count);
<a name="l00322"></a>00322         <span class="keywordflow">if</span> ((rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)) {
<a name="l00323"></a>00323           printf(<span class="stringliteral">&quot;Failed to get trunk info. Error %s\n&quot;</span>,
<a name="l00324"></a>00324                  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00325"></a>00325           <span class="keywordflow">continue</span>;
<a name="l00326"></a>00326         }
<a name="l00327"></a>00327         printf(<span class="stringliteral">&quot;trunk %d has %d members, psc %d\n&quot;</span>, tid ,member_count, t_data.<a class="code" href="structopennsl__trunk__info__s.html#ad6bff614540c6d0fb83f1c385ce65cb3" title="Port selection criteria.">psc</a>);
<a name="l00328"></a>00328         <span class="keywordflow">for</span>( i = 0; i &lt; member_count; i++)
<a name="l00329"></a>00329         {
<a name="l00330"></a>00330           <a class="code" href="group__port.html#ga3da90cb7aff8b4a22742fd811c218e77" title="Get local port number encoded within a GPORT ID.">opennsl_port_local_get</a>(unit, member_arr[i].gport, &amp;port);
<a name="l00331"></a>00331           printf(<span class="stringliteral">&quot;port %d\n&quot;</span>,port);
<a name="l00332"></a>00332         }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334         <span class="keywordflow">break</span>;
<a name="l00335"></a>00335       } <span class="comment">/* End of case 4 */</span>
<a name="l00336"></a>00336 
<a name="l00337"></a>00337       <span class="keywordflow">case</span> 5:
<a name="l00338"></a>00338       {
<a name="l00339"></a>00339         <span class="comment">/* Delete a trunk */</span>
<a name="l00340"></a>00340         printf(<span class="stringliteral">&quot;\r\nEnter the trunk id.\r\n&quot;</span>);
<a name="l00341"></a>00341         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;tid) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00342"></a>00342         {
<a name="l00343"></a>00343             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00344"></a>00344             <span class="keywordflow">continue</span>;
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         rv = <a class="code" href="group__trunk.html#ga809e2b02d5955b81bae9dd7416895a4e" title="Removes a trunk group.">opennsl_trunk_destroy</a>(unit, tid);
<a name="l00348"></a>00348         <span class="keywordflow">if</span> ((rv == <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)) {
<a name="l00349"></a>00349           printf(<span class="stringliteral">&quot;trunk %d successfully deleted\n&quot;</span>, tid);
<a name="l00350"></a>00350         } <span class="keywordflow">else</span> {
<a name="l00351"></a>00351           printf(<span class="stringliteral">&quot;Failed to delete trunk. Error %s\n&quot;</span>,
<a name="l00352"></a>00352                  <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00353"></a>00353           <span class="keywordflow">continue</span>;
<a name="l00354"></a>00354         }
<a name="l00355"></a>00355 
<a name="l00356"></a>00356         <span class="keywordflow">break</span>;
<a name="l00357"></a>00357       } <span class="comment">/* End of case 5 */</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359       <span class="keywordflow">case</span> 6:
<a name="l00360"></a>00360       {
<a name="l00361"></a>00361         <span class="comment">/* Sync the current configuration */</span>
<a name="l00362"></a>00362         rv = <a class="code" href="group__switch.html#gaecf4eb5e6b57081dc8f06c72919e4e0b" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_set</a>(<a class="code" href="example__trunk_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33ca0aa383217d779424e826a470d4c924ae" title="Force a sync of the Level 2 warm boot state on demand.">opennslSwitchControlSync</a>, 1);
<a name="l00363"></a>00363         <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00364"></a>00364           printf(<span class="stringliteral">&quot;Failed to synchronize the configuration to scache. &quot;</span>
<a name="l00365"></a>00365               <span class="stringliteral">&quot;Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00366"></a>00366           <span class="keywordflow">return</span> rv;
<a name="l00367"></a>00367         }
<a name="l00368"></a>00368         printf(<span class="stringliteral">&quot;Warmboot configuration is saved successfully.\n&quot;</span>);
<a name="l00369"></a>00369         <span class="keywordflow">break</span>;
<a name="l00370"></a>00370       } <span class="comment">/* End of case 6 */</span>
<a name="l00371"></a>00371 
<a name="l00372"></a>00372       <span class="keywordflow">case</span> 7:
<a name="l00373"></a>00373       {
<a name="l00374"></a>00374         printf(<span class="stringliteral">&quot;\r\nEnter the trunk id.\r\n&quot;</span>);
<a name="l00375"></a>00375         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;tid) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00376"></a>00376         {
<a name="l00377"></a>00377             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00378"></a>00378             <span class="keywordflow">continue</span>;
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         printf(<span class="stringliteral">&quot;\r\nEnter the PSC.\r\n&quot;</span>);
<a name="l00382"></a>00382         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;psc) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384             printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00385"></a>00385             <span class="keywordflow">continue</span>;
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388         rv = <a class="code" href="group__trunk.html#ga1137e1e37e0392c40e53b91c03d1b3ff" title="Set a trunk&#39;s Port Selection Criteria (PSC).">opennsl_trunk_psc_set</a>(unit, tid, psc);
<a name="l00389"></a>00389         <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) {
<a name="l00390"></a>00390           printf(<span class="stringliteral">&quot;Failed to set the PSC. Error %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00391"></a>00391         }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         <span class="keywordflow">break</span>;
<a name="l00394"></a>00394       }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00397"></a>00397 <span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:
<a name="l00398"></a>00398       {
<a name="l00399"></a>00399         opennsl_driver_shell();
<a name="l00400"></a>00400         <span class="keywordflow">break</span>;
<a name="l00401"></a>00401       }
<a name="l00402"></a>00402 <span class="preprocessor">#endif</span>
<a name="l00403"></a>00403 <span class="preprocessor"></span>
<a name="l00404"></a>00404       <span class="keywordflow">case</span> 0:
<a name="l00405"></a>00405       {
<a name="l00406"></a>00406         printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);
<a name="l00407"></a>00407         rv = <a class="code" href="driver_8h.html#aa760e8f1af45c7fd27ec014b82c572f2" title="Function to free up the resources and exit the driver.">opennsl_driver_exit</a>();
<a name="l00408"></a>00408         <span class="keywordflow">return</span> rv;
<a name="l00409"></a>00409       }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411       <span class="keywordflow">default</span>:
<a name="l00412"></a>00412         <span class="keywordflow">break</span>;
<a name="l00413"></a>00413     } <span class="comment">/* End of switch */</span>
<a name="l00414"></a>00414   } <span class="comment">/* End of while */</span>
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00417"></a>00417 }
<a name="l00418"></a>00418 <span class="comment">/* __doxy_func_body_end__ */</span>
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->





</body>
</html>
