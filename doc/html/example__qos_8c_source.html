<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>OpenNSL API Guide and Reference Manual: examples/dpp/example_qos.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen/doxygen_brcm.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNSL API Guide and Reference Manual
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="pages.html"><span>OpenNSL&#160;Documentation</span></a></li>
      <li><a href="modules.html"><span>API&#160;Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">examples/dpp/example_qos.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="example__qos_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*********************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *</span>
<a name="l00003"></a>00003 <span class="comment"> * (C) Copyright Broadcom Corporation 2013-2017</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<a name="l00006"></a>00006 <span class="comment"> *  you may not use this file except in compliance with the License.</span>
<a name="l00007"></a>00007 <span class="comment"> *  You may obtain a copy of the License at</span>
<a name="l00008"></a>00008 <span class="comment"> *</span>
<a name="l00009"></a>00009 <span class="comment"> *      http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span>
<a name="l00012"></a>00012 <span class="comment"> *  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a name="l00013"></a>00013 <span class="comment"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00014"></a>00014 <span class="comment"> *  See the License for the specific language governing permissions and</span>
<a name="l00015"></a>00015 <span class="comment"> *  limitations under the License.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> **********************************************************************</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * \file         example_qos.c</span>
<a name="l00020"></a>00020 <span class="comment"> *</span>
<a name="l00021"></a>00021 <span class="comment"> * \brief        OpenNSL example application for QoS based on port</span>
<a name="l00022"></a>00022 <span class="comment"> *</span>
<a name="l00023"></a>00023 <span class="comment"> * \details      In this example, we will map TC and DP from the packet PCP</span>
<a name="l00024"></a>00024 <span class="comment"> *               (targeted for tagged packet) including three modes:</span>
<a name="l00025"></a>00025 <span class="comment"> *               1. map dei without cfi for s tagged packet when use_de=0</span>
<a name="l00026"></a>00026 <span class="comment"> *               2. map dei with cfi for s tagged packet when use_de=1</span>
<a name="l00027"></a>00027 <span class="comment"> *               3. map up to dp for c tagged packet</span>
<a name="l00028"></a>00028 <span class="comment"> *</span>
<a name="l00029"></a>00029 <span class="comment"> *  use_de can be 0 or 1. 0 stands for not mapping dei without cfi; 1 stands for mapping dei with cfi.</span>
<a name="l00030"></a>00030 <span class="comment"> *  Send Traffic from input port, say 2 and receive it on port 3 when use_de is 0:</span>
<a name="l00031"></a>00031 <span class="comment"> *  1. In port 2 vid 100 prio 0 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 1 cfi 1</span>
<a name="l00032"></a>00032 <span class="comment"> *  2. In port 2 vid 100 prio 1 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 2 cfi 0</span>
<a name="l00033"></a>00033 <span class="comment"> *  3. In port 2 vid 100 prio 2 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 3 cfi 1</span>
<a name="l00034"></a>00034 <span class="comment"> *  4. In port 2 vid 100 prio 3 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 4 cfi 0</span>
<a name="l00035"></a>00035 <span class="comment"> *  5. In port 2 vid 100 prio 4 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 5 cfi 1</span>
<a name="l00036"></a>00036 <span class="comment"> *  6. In port 2 vid 100 prio 5 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 6 cfi 0</span>
<a name="l00037"></a>00037 <span class="comment"> *  7. In port 2 vid 100 prio 6 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 7 cfi 1</span>
<a name="l00038"></a>00038 <span class="comment"> *  8. In port 2 vid 100 prio 7 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 7 cfi 0</span>
<a name="l00039"></a>00039 <span class="comment"> *  Send Traffic from port 2 and receive it on port 3 when use_de is 1:</span>
<a name="l00040"></a>00040 <span class="comment"> *  1. In port 2 vid 100 prio 0 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 1 cfi 0</span>
<a name="l00041"></a>00041 <span class="comment"> *  2. In port 2 vid 100 prio 1 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 2 cfi 1</span>
<a name="l00042"></a>00042 <span class="comment"> *  3. In port 2 vid 100 prio 2 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 3 cfi 0</span>
<a name="l00043"></a>00043 <span class="comment"> *  4. In port 2 vid 100 prio 3 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 4 cfi 1</span>
<a name="l00044"></a>00044 <span class="comment"> *  5. In port 2 vid 100 prio 4 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 5 cfi 0</span>
<a name="l00045"></a>00045 <span class="comment"> *  6. In port 2 vid 100 prio 5 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 6 cfi 1</span>
<a name="l00046"></a>00046 <span class="comment"> *  7. In port 2 vid 100 prio 6 cfi 0  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 7 cfi 0</span>
<a name="l00047"></a>00047 <span class="comment"> *  8. In port 2 vid 100 prio 7 cfi 1  &lt;-----CrossConnect-----&gt;  Out port 3 vid 300 prio 7 cfi 1</span>
<a name="l00048"></a>00048 <span class="comment"> * </span>
<a name="l00049"></a>00049 <span class="comment"> **********************************************************************/</span>
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2error_8h.html">opennsl/error.h</a>&gt;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &lt;<a class="code" href="init_8h.html">opennsl/init.h</a>&gt;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2port_8h.html">opennsl/port.h</a>&gt;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &lt;<a class="code" href="l2_8h.html">opennsl/l2.h</a>&gt;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &lt;<a class="code" href="vlan_8h.html">opennsl/vlan.h</a>&gt;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &lt;<a class="code" href="opennsl_2switch_8h.html">opennsl/switch.h</a>&gt;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &lt;<a class="code" href="vswitch_8h.html">opennsl/vswitch.h</a>&gt;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &lt;<a class="code" href="qos_8h.html">opennsl/qos.h</a>&gt;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &lt;<a class="code" href="examples_2util_8h.html">examples/util.h</a>&gt;</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="example__qos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">00065</a> <span class="keywordtype">char</span> <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>[] =
<a name="l00066"></a>00066 <span class="stringliteral">&quot;Syntax: example_qos                                                    \n\r&quot;</span>
<a name="l00067"></a>00067 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00068"></a>00068 <span class="stringliteral">&quot;Paramaters: None.                                                      \n\r&quot;</span>
<a name="l00069"></a>00069 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00070"></a>00070 <span class="stringliteral">&quot;Example: The following command is used to map the TC and DP from the   \n\r&quot;</span>
<a name="l00071"></a>00071 <span class="stringliteral">&quot;         VLAN tagged packet, with tag ID 100.                          \n\r&quot;</span>
<a name="l00072"></a>00072 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00073"></a>00073 <span class="stringliteral">&quot;         example_qos                                                   \n\r&quot;</span>
<a name="l00074"></a>00074 <span class="stringliteral">&quot;                                                                       \n\r&quot;</span>
<a name="l00075"></a>00075 <span class="stringliteral">&quot;Usage Guidelines: None.                                                \n\r&quot;</span>;
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="example__qos_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">00077</a> <span class="preprocessor">#define DEFAULT_UNIT 0</span>
<a name="l00078"></a><a class="code" href="example__qos_8c.html#a91668ed1245d073a2ac84e6121205d28">00078</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_VLAN 1</span>
<a name="l00079"></a><a class="code" href="example__qos_8c.html#a074e4c6c5b35a6e7df06fbc024b0760d">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define MAC_DA        {0x00, 0x00, 0x00, 0x00, 0x00, 0x01}</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00081"></a><a class="code" href="example__qos_8c.html#a523822b8d626fa4bcd6cfa36a6d8c0be">00081</a> <span class="preprocessor">#define MAC_MASK      {0xff, 0xff, 0xff, 0xff, 0xff, 0xff}</span>
<a name="l00082"></a>00082 <span class="preprocessor"></span><span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="example__qos_8c.html#a3dac63c8a5b5d1ccf667d0f7374ea64e">00084</a> <a class="code" href="group__types.html#gaff94709d1708a51eb9aadb2e9fa03875" title="opennsl_vlan_t">opennsl_vlan_t</a> <a class="code" href="example__qos_8c.html#a3dac63c8a5b5d1ccf667d0f7374ea64e">up_ovlan</a> = 100;
<a name="l00085"></a><a class="code" href="example__qos_8c.html#a5be88c338e62fa10f68b2344cc53b7d6">00085</a> <a class="code" href="group__types.html#gaff94709d1708a51eb9aadb2e9fa03875" title="opennsl_vlan_t">opennsl_vlan_t</a> <a class="code" href="example__qos_8c.html#a5be88c338e62fa10f68b2344cc53b7d6">down_ovlan1</a> = 200;
<a name="l00086"></a><a class="code" href="example__qos_8c.html#aeea8641b678030d4ba20b5a9fc0ffef7">00086</a> <a class="code" href="group__types.html#gaff94709d1708a51eb9aadb2e9fa03875" title="opennsl_vlan_t">opennsl_vlan_t</a> <a class="code" href="example__qos_8c.html#aeea8641b678030d4ba20b5a9fc0ffef7">down_ovlan2</a> = 300;
<a name="l00087"></a><a class="code" href="example__qos_8c.html#a5e45f11b828c71c9c621bf12f9f0f37a">00087</a> <a class="code" href="structopennsl__vlan__port__s.html" title="Layer 2 Logical port type.">opennsl_vlan_port_t</a> <a class="code" href="example__qos_8c.html#a611a7708477876b54ecb88627aef9f5f">in_vlan_port1</a>, <a class="code" href="example__qos_8c.html#afa99e174a68c21a77440eed92a6296bb">in_vlan_port2</a>, <a class="code" href="example__qos_8c.html#aa308b122179ffb9bad17797b345d5e3c">out_vlan_port1</a>, <a class="code" href="example__qos_8c.html#a5e45f11b828c71c9c621bf12f9f0f37a">out_vlan_port2</a>;
<a name="l00088"></a><a class="code" href="example__qos_8c.html#a942336885851df0b2b58a1db305d6a6f">00088</a> <a class="code" href="structopennsl__vswitch__cross__connect__s.html" title="L3 tunneling initiator.">opennsl_vswitch_cross_connect_t</a> <a class="code" href="example__qos_8c.html#a942336885851df0b2b58a1db305d6a6f">gports_untag</a>, <a class="code" href="example__qos_8c.html#ae88ff94d5228fbb1a5a1da72580db706">gports_tag</a>;
<a name="l00089"></a><a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">00089</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[2];
<a name="l00090"></a>00090 
<a name="l00091"></a><a class="code" href="example__qos_8c.html#a8a19f7607d887deff271382fdd0d8e71">00091</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a8a19f7607d887deff271382fdd0d8e71">pkt_pri</a>[8] = {0,1,2,3,4,5,6,7};
<a name="l00092"></a>00092 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00093"></a><a class="code" href="example__qos_8c.html#ae29cb3f7c20f2a4f97e347299de1eab3">00093</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#ae29cb3f7c20f2a4f97e347299de1eab3">pkt_cfi</a>[8] = {0,1,0,1,0,1,0,1};
<a name="l00094"></a>00094 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00095"></a><a class="code" href="example__qos_8c.html#a11e9e0c74f0b7eced2c28d2dca952a57">00095</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a11e9e0c74f0b7eced2c28d2dca952a57">internal_pri</a>[8] = {1,2,3,4,5,6,7,7};
<a name="l00096"></a>00096 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00097"></a><a class="code" href="example__qos_8c.html#ab1c7cd7429c646bc3b414c3f69b5a389">00097</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#ab1c7cd7429c646bc3b414c3f69b5a389">internal_color_stag_with_use_de</a>[8] = {0,1,0,1,0,1,0,1};
<a name="l00098"></a>00098 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00099"></a><a class="code" href="example__qos_8c.html#a58b71ca8297fdc4e997e77d30b9902f5">00099</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a58b71ca8297fdc4e997e77d30b9902f5">internal_color_stag_with_no_use_de</a>[8] = {1,0,1,0,1,0,1,0};
<a name="l00100"></a>00100 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00101"></a><a class="code" href="example__qos_8c.html#aae4f6180472805fc90a63703eb246474">00101</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#aae4f6180472805fc90a63703eb246474">internal_color_ctag</a>[8] = {0,0,0,0,1,1,1,1};           
<a name="l00102"></a>00102 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00103"></a>00103          
<a name="l00104"></a><a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72">00104</a> <span class="keyword">enum</span> <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72">service_type_e</a> {
<a name="l00105"></a><a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">00105</a>     <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>,
<a name="l00106"></a><a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">00106</a>     <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>
<a name="l00107"></a>00107 };
<a name="l00108"></a>00108 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00109"></a>00109  
<a name="l00110"></a><a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5a">00110</a> <span class="keyword">enum</span> <a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5a">use_de_type_e</a> {
<a name="l00111"></a><a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa276f1ff5c39c54d1253557d5fe141726">00111</a>     <a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa276f1ff5c39c54d1253557d5fe141726">with_no_use_de</a>,
<a name="l00112"></a><a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa403bab0af8dfbf8a2c156aa0ac7c86af">00112</a>     <a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa403bab0af8dfbf8a2c156aa0ac7c86af">with_use_de</a>
<a name="l00113"></a>00113 };
<a name="l00114"></a>00114 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00115"></a>00115  
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">/* Map TC and DP from the packet PCP */</span> 
<a name="l00118"></a><a class="code" href="example__qos_8c.html#ae31c8867a38c33e793aff85a3c8a7627">00118</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#ae31c8867a38c33e793aff85a3c8a7627">qos_pcp_map_create</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> <a class="code" href="opennsl__api_8dox.html#abd1fe5382f13606db566da3450b351b0">port</a>, <span class="keywordtype">int</span> is_use_de) 
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120   <span class="keywordtype">int</span> color = 0;
<a name="l00121"></a>00121   <span class="keywordtype">int</span> mode = 0;
<a name="l00122"></a>00122   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00123"></a>00123   <span class="keywordtype">int</span> idx;
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="comment">/* set the mode of mapping pcp */</span>
<a name="l00126"></a>00126   mode = <a class="code" href="group__port.html#ga15e47bbc2a1a16f6e068f9ed6390bb4e" title="Disable DSCP mapping.">OPENNSL_PORT_DSCP_MAP_NONE</a>;
<a name="l00127"></a>00127   rv = <a class="code" href="group__port.html#ga8f1dd711fff389d3843fbabb5e7ee2bc" title="Control mapping of Differentiated Services Code Points (DSCP).">opennsl_port_dscp_map_mode_set</a>(unit, -1, mode);    <span class="comment">/* global configuration, port has to be -1 */</span>
<a name="l00128"></a>00128   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00129"></a>00129   {
<a name="l00130"></a>00130     printf(<span class="stringliteral">&quot;error in opennsl_port_dscp_map_mode_set() $rv\n&quot;</span>);
<a name="l00131"></a>00131     <span class="keywordflow">return</span> rv;
<a name="l00132"></a>00132   }
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <span class="keywordflow">switch</span> (is_use_de) 
<a name="l00135"></a>00135   {
<a name="l00136"></a>00136     <span class="keywordflow">case</span> <a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa276f1ff5c39c54d1253557d5fe141726">with_no_use_de</a>:
<a name="l00137"></a>00137       <span class="comment">/* set the mode of mapping dei without cfi for s tagged pkt */</span>
<a name="l00138"></a>00138       rv = <a class="code" href="group__switch.html#ga0a7f6e2ec0486325bf5359db5388febd" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_port_set</a>(unit, port, <a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33caee971ff69db06a1802c1c6d827a7847f" title="Choose color selection source.">opennslSwitchColorSelect</a>, <a class="code" href="group__switch.html#ga3b7b63e0ad3886328e4786012c0f1f0b" title="Priority-&gt;COLOR mapping.">OPENNSL_COLOR_PRIORITY</a>);
<a name="l00139"></a>00139       <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00140"></a>00140       {
<a name="l00141"></a>00141         printf(<span class="stringliteral">&quot;error in opennsl_switch_control_port_set() $rv\n&quot;</span>);
<a name="l00142"></a>00142         <span class="keywordflow">return</span> rv;
<a name="l00143"></a>00143       }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145       <span class="comment">/* set the mapping of TC and DP for tagged packet */</span>
<a name="l00146"></a>00146       <span class="keywordflow">for</span> (idx = 0; idx &lt; 8; idx++) 
<a name="l00147"></a>00147       {               
<a name="l00148"></a>00148         <span class="comment">/* map tc and dp from PCP for tagged pkt */</span>
<a name="l00149"></a>00149         rv = <a class="code" href="group__port.html#ga15667a93ccb19b29d1e6509a5932e73e">opennsl_port_vlan_priority_map_set</a>(unit, port, <a class="code" href="example__qos_8c.html#a8a19f7607d887deff271382fdd0d8e71">pkt_pri</a>[idx], 0, <a class="code" href="example__qos_8c.html#a11e9e0c74f0b7eced2c28d2dca952a57">internal_pri</a>[idx], <a class="code" href="example__qos_8c.html#a58b71ca8297fdc4e997e77d30b9902f5">internal_color_stag_with_no_use_de</a>[idx]);   <span class="comment">/* cfi must be 0 because it isn&#39;t used */</span>
<a name="l00150"></a>00150         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152           printf(<span class="stringliteral">&quot;error in opennsl_port_vlan_priority_map_set() $rv\n&quot;</span>);
<a name="l00153"></a>00153           <span class="keywordflow">return</span> rv;
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155       }
<a name="l00156"></a>00156       <span class="keywordflow">break</span>;
<a name="l00157"></a>00157     <span class="keywordflow">case</span> <a class="code" href="example__qos_8c.html#a63e852d4088e913d25399c41e30daf5aa403bab0af8dfbf8a2c156aa0ac7c86af">with_use_de</a>:
<a name="l00158"></a>00158       <span class="comment">/* set the mapping of TC for tagged packet */</span>
<a name="l00159"></a>00159       <span class="keywordflow">for</span> (idx = 0; idx &lt; 8; idx++) 
<a name="l00160"></a>00160       {              
<a name="l00161"></a>00161         <span class="comment">/* map tc from PCP for tagged packet*/</span>
<a name="l00162"></a>00162         rv = <a class="code" href="group__port.html#ga15667a93ccb19b29d1e6509a5932e73e">opennsl_port_vlan_priority_map_set</a>(unit, port, <a class="code" href="example__qos_8c.html#a8a19f7607d887deff271382fdd0d8e71">pkt_pri</a>[idx], 0, <a class="code" href="example__qos_8c.html#a11e9e0c74f0b7eced2c28d2dca952a57">internal_pri</a>[idx], color); <span class="comment">/* cfi must be 0 because it isn&#39;t used */</span>
<a name="l00163"></a>00163         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00164"></a>00164         {
<a name="l00165"></a>00165           printf(<span class="stringliteral">&quot;error in opennsl_port_vlan_priority_map_set() $rv\n&quot;</span>);
<a name="l00166"></a>00166           <span class="keywordflow">return</span> rv;
<a name="l00167"></a>00167         }
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <span class="comment">/* set the mode of mapping dei with cfi */</span>
<a name="l00170"></a>00170         rv = <a class="code" href="group__switch.html#ga0a7f6e2ec0486325bf5359db5388febd" title="Configure port-specific and device-wide operating modes.">opennsl_switch_control_port_set</a>(unit,port,<a class="code" href="group__switch.html#gga8465f9bee535c4a0c8e4360bcc21e33caee971ff69db06a1802c1c6d827a7847f" title="Choose color selection source.">opennslSwitchColorSelect</a>,<a class="code" href="group__switch.html#gaad5e07c5932512c1e8604a6274fd7bf8" title="SPVLAN CFI-&gt;COLOR mapping.">OPENNSL_COLOR_OUTER_CFI</a>);
<a name="l00171"></a>00171         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00172"></a>00172         {
<a name="l00173"></a>00173           printf(<span class="stringliteral">&quot;error in opennsl_switch_control_port_set() $rv\n&quot;</span>);
<a name="l00174"></a>00174           <span class="keywordflow">return</span> rv;
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <span class="comment">/* map dei with cfi for s tagged pkt */</span>
<a name="l00178"></a>00178         rv = <a class="code" href="group__port.html#gae4bd3ff28640ca5b600e588d37a8a6ed" title="Set or retrieve color assignment for a given port and Canonical Format Indicator (CFI).">opennsl_port_cfi_color_set</a>(unit, -1, <a class="code" href="example__qos_8c.html#ae29cb3f7c20f2a4f97e347299de1eab3">pkt_cfi</a>[idx], <a class="code" href="example__qos_8c.html#ab1c7cd7429c646bc3b414c3f69b5a389">internal_color_stag_with_use_de</a>[idx]);  <span class="comment">/* global configuration, port has to be -1 */</span>
<a name="l00179"></a>00179         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00180"></a>00180         {
<a name="l00181"></a>00181           printf(<span class="stringliteral">&quot;error in opennsl_port_cfi_color_set() $rv\n&quot;</span>);
<a name="l00182"></a>00182           <span class="keywordflow">return</span> rv;
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184       }
<a name="l00185"></a>00185       <span class="keywordflow">break</span>;
<a name="l00186"></a>00186     <span class="keywordflow">default</span>:
<a name="l00187"></a>00187       <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;    
<a name="l00188"></a>00188   }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <span class="comment">/* map up to dp for c tagged pkt */</span>
<a name="l00191"></a>00191   <span class="keywordflow">for</span> (idx = 0x0; idx &lt; 0x8; idx++) 
<a name="l00192"></a>00192   {
<a name="l00193"></a>00193     rv = <a class="code" href="group__port.html#gabac44f58ca77a030e1eb930fc0c4d281" title="Set or retrieve color assignment for a given port and priority.">opennsl_port_priority_color_set</a>(unit, port, <a class="code" href="example__qos_8c.html#a8a19f7607d887deff271382fdd0d8e71">pkt_pri</a>[idx], <a class="code" href="example__qos_8c.html#aae4f6180472805fc90a63703eb246474">internal_color_ctag</a>[idx]);
<a name="l00194"></a>00194     <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00195"></a>00195     {
<a name="l00196"></a>00196       printf(<span class="stringliteral">&quot;error in opennsl_port_priority_color_set() $rv\n&quot;</span>);
<a name="l00197"></a>00197       <span class="keywordflow">return</span> rv;
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199   }
<a name="l00200"></a>00200 
<a name="l00201"></a>00201   <span class="keywordflow">return</span> rv;
<a name="l00202"></a>00202 } 
<a name="l00203"></a>00203 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00204"></a>00204 
<a name="l00205"></a>00205 <span class="comment">/* </span>
<a name="l00206"></a>00206 <span class="comment"> * Create default l2 egress mapping profile.</span>
<a name="l00207"></a>00207 <span class="comment"> * When adding or modifying a new VLAN tag, cos of the new tag is based on the default mapping profile.</span>
<a name="l00208"></a>00208 <span class="comment"> */</span>
<a name="l00209"></a><a class="code" href="example__qos_8c.html#a82d05e2a85bb80929621fbb076d4487f">00209</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a82d05e2a85bb80929621fbb076d4487f">qos_map_l2_eg_dft_profile</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> service_type)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211   <a class="code" href="structopennsl__qos__map__s.html" title="QoS Map structure.">opennsl_qos_map_t</a> l2_eg_map;
<a name="l00212"></a>00212   <span class="keywordtype">int</span> flags = 0;
<a name="l00213"></a>00213   <span class="keywordtype">int</span> idx = 0;
<a name="l00214"></a>00214   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00215"></a>00215 
<a name="l00216"></a>00216   <span class="comment">/* Clear structure */</span>
<a name="l00217"></a>00217   rv = <a class="code" href="group__qos.html#gacac84391e81a17e3931ff010edc16fbc" title="Allocates hardware resources for QoS mapping.">opennsl_qos_map_create</a>(unit, <a class="code" href="group__qos.html#gaca0749743282b2c8ecbbc2aad64ee143">OPENNSL_QOS_MAP_EGRESS</a>|<a class="code" href="group__qos.html#ga4ed7bc917da5208fbc5e5eedda72f58e">OPENNSL_QOS_MAP_L2_VLAN_PCP</a>, &amp;<a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[service_type]);
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00220"></a>00220   {
<a name="l00221"></a>00221     printf(<span class="stringliteral">&quot;error in egress PCP opennsl_qos_map_create() $rv\n&quot;</span>);
<a name="l00222"></a>00222     <span class="keywordflow">return</span> rv;
<a name="l00223"></a>00223   }
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="keywordflow">for</span> (idx=0; idx&lt;16; idx++) 
<a name="l00226"></a>00226   {  
<a name="l00227"></a>00227     <a class="code" href="group__qos.html#gad16de3c9482ecdb12a094974e099679e" title="Initialize the QoS Map structure.">opennsl_qos_map_t_init</a>(&amp;l2_eg_map);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="comment">/* Set ingress pkt_pri/cfi Priority */</span>
<a name="l00230"></a>00230     l2_eg_map.<a class="code" href="structopennsl__qos__map__s.html#a176c4c022b72d74aee0005432e476003" title="Packet priority.">pkt_pri</a> = idx&gt;&gt;1;
<a name="l00231"></a>00231     l2_eg_map.<a class="code" href="structopennsl__qos__map__s.html#aaf206499b42d591e3a98d840cd51f4e8" title="Packet CFI.">pkt_cfi</a> = idx&amp;1;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233     <span class="comment">/* Set internal priority for this ingress pri */</span>
<a name="l00234"></a>00234     l2_eg_map.<a class="code" href="structopennsl__qos__map__s.html#a52a7ea7f2489ac1bbf4882ccb717b1e7" title="Internal priority.">int_pri</a> = idx&gt;&gt;1;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <span class="comment">/* Set color for this ingress Priority 0:opennslColorGreen 1:opennslColorYellow */</span>
<a name="l00237"></a>00237     l2_eg_map.<a class="code" href="structopennsl__qos__map__s.html#a767735bce0217e4514f452355c4e1fd5" title="Color.">color</a> = idx&amp;1;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <span class="keywordflow">if</span> (service_type == <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>) 
<a name="l00240"></a>00240     {
<a name="l00241"></a>00241       flags = <a class="code" href="group__qos.html#ga10a21d232a4a6beebcb9bf2b8d65a573">OPENNSL_QOS_MAP_L2</a>|<a class="code" href="group__qos.html#ga4ed7bc917da5208fbc5e5eedda72f58e">OPENNSL_QOS_MAP_L2_VLAN_PCP</a>|<a class="code" href="group__qos.html#gadb14eedbd8eae7a89cbac2d5c8234d07">OPENNSL_QOS_MAP_L2_UNTAGGED</a>|<a class="code" href="group__qos.html#gaca0749743282b2c8ecbbc2aad64ee143">OPENNSL_QOS_MAP_EGRESS</a>;        
<a name="l00242"></a>00242     } 
<a name="l00243"></a>00243     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (service_type == <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>) 
<a name="l00244"></a>00244     {
<a name="l00245"></a>00245       flags = <a class="code" href="group__qos.html#ga10a21d232a4a6beebcb9bf2b8d65a573">OPENNSL_QOS_MAP_L2</a>|<a class="code" href="group__qos.html#ga4ed7bc917da5208fbc5e5eedda72f58e">OPENNSL_QOS_MAP_L2_VLAN_PCP</a>|<a class="code" href="group__qos.html#ga630da06c619a1287c18e0a5128f919a0">OPENNSL_QOS_MAP_L2_OUTER_TAG</a>|<a class="code" href="group__qos.html#gaca0749743282b2c8ecbbc2aad64ee143">OPENNSL_QOS_MAP_EGRESS</a>;
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     rv = <a class="code" href="group__qos.html#gae5768c6ed5a320b404143298f4724b52" title="Add a specific mapping entry to a QoS map.">opennsl_qos_map_add</a>(unit, flags, &amp;l2_eg_map, <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[service_type]);    
<a name="l00249"></a>00249     <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251       printf(<span class="stringliteral">&quot;error in PCP egress opennsl_qos_map_add() $rv\n&quot;</span>);
<a name="l00252"></a>00252       <span class="keywordflow">return</span> rv;
<a name="l00253"></a>00253     }  
<a name="l00254"></a>00254   }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256   <span class="keywordflow">return</span> rv;
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="comment">/* edit the eve action, map internal tc and dp to pkt_pri and pkt_cfi */</span>
<a name="l00261"></a><a class="code" href="example__qos_8c.html#a2d4531e9c41943ae8e6268c4490291be">00261</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a2d4531e9c41943ae8e6268c4490291be">initial_qos_service_vlan_action_set</a>(<span class="keywordtype">int</span> unit, <span class="keywordtype">int</span> service_type)
<a name="l00262"></a>00262 {
<a name="l00263"></a>00263   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00264"></a>00264   <a class="code" href="structopennsl__vlan__port__s.html" title="Layer 2 Logical port type.">opennsl_vlan_port_t</a> *vlan_port = <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;
<a name="l00265"></a>00265   <a class="code" href="structopennsl__vlan__action__set__s.html" title="Initialize a VLAN tag action set structure.">opennsl_vlan_action_set_t</a> action;
<a name="l00266"></a>00266   <a class="code" href="group__vlan.html#gaed6082cf2b41282eeddaffec22668f28" title="Initialize a VLAN tag action set structure.">opennsl_vlan_action_set_t_init</a>(&amp;action);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268   <span class="keywordflow">switch</span> (service_type)
<a name="l00269"></a>00269   {
<a name="l00270"></a>00270       <span class="keywordflow">case</span> <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>:
<a name="l00271"></a>00271           <span class="comment">/* eve action for untagged service */</span>
<a name="l00272"></a>00272           action.<a class="code" href="structopennsl__vlan__action__set__s.html#ae02e6e5eddf1a00666b9ad2e0c8e01a7" title="Outer-tag action for untagged packets.">ut_outer</a> = <a class="code" href="group__types.html#ggadf0e38b647693b21df556fb5417b67e9a01a4c0d53f46abe28badcd882a31685e" title="Add VLAN tag.">opennslVlanActionAdd</a>;
<a name="l00273"></a>00273           action.<a class="code" href="structopennsl__vlan__action__set__s.html#af0581476c7d3fdbc013c07239f032a74" title="New outer VLAN for Add/Replace actions.">new_outer_vlan</a> = <a class="code" href="example__qos_8c.html#a5be88c338e62fa10f68b2344cc53b7d6">down_ovlan1</a>;                
<a name="l00274"></a>00274           action.<a class="code" href="structopennsl__vlan__action__set__s.html#a7e22ea274dee5752c3075e1a4ae44be5" title="Outer packet priority action for untagged packets.">ut_outer_pkt_prio</a> = <a class="code" href="group__types.html#ggadf0e38b647693b21df556fb5417b67e9a01a4c0d53f46abe28badcd882a31685e" title="Add VLAN tag.">opennslVlanActionAdd</a>;
<a name="l00275"></a>00275           action.<a class="code" href="structopennsl__vlan__action__set__s.html#abf02e8ed6c077867433250f164ee8378" title="Internal or packet priority.">priority</a> = <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[service_type];
<a name="l00276"></a>00276           vlan_port = &amp;<a class="code" href="example__qos_8c.html#aa308b122179ffb9bad17797b345d5e3c">out_vlan_port1</a>;
<a name="l00277"></a>00277           <span class="keywordflow">break</span>;
<a name="l00278"></a>00278       <span class="keywordflow">case</span> <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>:
<a name="l00279"></a>00279           <span class="comment">/* eve action for tagged service */</span>
<a name="l00280"></a>00280           action.<a class="code" href="structopennsl__vlan__action__set__s.html#af60ad1ada9311f4900ac4ce27a3b1a50" title="Outer-tag action for single-outer-tagged packets.">ot_outer</a> = <a class="code" href="group__types.html#ggadf0e38b647693b21df556fb5417b67e9ac8b1eadb80e4b018772b05cbf8bf87ef" title="Replace VLAN tag.">opennslVlanActionReplace</a>; 
<a name="l00281"></a>00281           action.<a class="code" href="structopennsl__vlan__action__set__s.html#af0581476c7d3fdbc013c07239f032a74" title="New outer VLAN for Add/Replace actions.">new_outer_vlan</a> = <a class="code" href="example__qos_8c.html#aeea8641b678030d4ba20b5a9fc0ffef7">down_ovlan2</a>;
<a name="l00282"></a>00282           action.<a class="code" href="structopennsl__vlan__action__set__s.html#a8bd9731e2765f7006c9adacba4e4be8d" title="Outer packet priority action for single-outer-tagged packets.">ot_outer_pkt_prio</a> = <a class="code" href="group__types.html#ggadf0e38b647693b21df556fb5417b67e9ac8b1eadb80e4b018772b05cbf8bf87ef" title="Replace VLAN tag.">opennslVlanActionReplace</a>; <span class="comment">/* priority is set according to pcp_vlan_profile mapping */</span>
<a name="l00283"></a>00283           action.<a class="code" href="structopennsl__vlan__action__set__s.html#abf02e8ed6c077867433250f164ee8378" title="Internal or packet priority.">priority</a> = <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[<a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>];
<a name="l00284"></a>00284           vlan_port = &amp;<a class="code" href="example__qos_8c.html#a5e45f11b828c71c9c621bf12f9f0f37a">out_vlan_port2</a>;
<a name="l00285"></a>00285           <span class="keywordflow">break</span>;
<a name="l00286"></a>00286       <span class="keywordflow">default</span>:
<a name="l00287"></a>00287           <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00288"></a>00288   }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290   rv = <a class="code" href="group__vlan.html#gaab0d27a54c226cc44499f21bbed0a2cc" title="Add an entry to the egress VLAN Translation table and assign VLAN actions.">opennsl_vlan_translate_egress_action_add</a>(unit, vlan_port-&gt;<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>, <a class="code" href="group__types.html#ga8d40a12f9f7c4d2ad3d2a07f296847fe">OPENNSL_VLAN_NONE</a>, <a class="code" href="group__types.html#ga8d40a12f9f7c4d2ad3d2a07f296847fe">OPENNSL_VLAN_NONE</a>, &amp;action);
<a name="l00291"></a>00291   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00292"></a>00292   {
<a name="l00293"></a>00293     printf(<span class="stringliteral">&quot;error in eve translation opennsl_vlan_translate_egress_action_add() $rv\n&quot;</span>);
<a name="l00294"></a>00294   }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296   <span class="keywordflow">return</span> rv;
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="comment">/* initialize the vlan port and set the default egress qos profile</span>
<a name="l00302"></a>00302 <span class="comment">   service model:  untag pkt -&gt; vid 200</span>
<a name="l00303"></a>00303 <span class="comment">                   vid 100 -&gt; vid 300 </span>
<a name="l00304"></a>00304 <span class="comment">*/</span>
<a name="l00305"></a><a class="code" href="example__qos_8c.html#addcb57c9ee65d18f93545a731cd409c6">00305</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#addcb57c9ee65d18f93545a731cd409c6">initial_qos_service_init</a>(<span class="keywordtype">int</span> unit, <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> port_in, <a class="code" href="group__types.html#gacaeba2b4ddbc89b0e556720a9388885f" title="Set the default tag protocol ID (TPID) for the specified port.">opennsl_port_t</a> port_out) 
<a name="l00306"></a>00306 {
<a name="l00307"></a>00307   <span class="comment">/* initialize the vlan ports */</span>
<a name="l00308"></a>00308   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00309"></a>00309   <a class="code" href="group__vlan.html#gaa1bf59398c66fd46c9109b4fc9d79051" title="Initialize the VLAN port structure.">opennsl_vlan_port_t_init</a>(&amp;in_vlan_port1);
<a name="l00310"></a>00310   in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#ab94d90776edeb955129f95b07f287181" title="Match criteria.">criteria</a> = <a class="code" href="group__vlan.html#ggac691cd787b4b6aa9a2f8b83659d4af50a7d650e49c2c32a113a26577834095d68" title="{Module, Port} or Trunk.">OPENNSL_VLAN_PORT_MATCH_PORT</a>;
<a name="l00311"></a>00311   in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a> = port_in;
<a name="l00312"></a>00312   in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a7780aaa81891b515df40ae3696db218b" title="OPENNSL_VLAN_PORT_xxx.">flags</a> = (<a class="code" href="group__vlan.html#gacd3ff246480fbe6fe3623a5f315d187a" title="Preserve the outer VLAN tag (by default it is stripped).">OPENNSL_VLAN_PORT_OUTER_VLAN_PRESERVE</a> | <a class="code" href="group__vlan.html#ga2ca388882eeafa8c78514d8e00ba3a93" title="Preserve the inner VLAN tag (by default it is stripped).">OPENNSL_VLAN_PORT_INNER_VLAN_PRESERVE</a>);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314   <a class="code" href="group__vlan.html#gaa1bf59398c66fd46c9109b4fc9d79051" title="Initialize the VLAN port structure.">opennsl_vlan_port_t_init</a>(&amp;out_vlan_port1);
<a name="l00315"></a>00315   out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#ab94d90776edeb955129f95b07f287181" title="Match criteria.">criteria</a> = <a class="code" href="group__vlan.html#ggac691cd787b4b6aa9a2f8b83659d4af50a0e8e71613acf7f6159c59d446e5bb1d0" title="Mod/port/trunk + outer VLAN.">OPENNSL_VLAN_PORT_MATCH_PORT_VLAN</a>;
<a name="l00316"></a>00316   out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a10ec33efb60f9917b243dd872dc3858f" title="Outer VLAN ID to match.">match_vlan</a> = <a class="code" href="example__qos_8c.html#a5be88c338e62fa10f68b2344cc53b7d6">down_ovlan1</a>;
<a name="l00317"></a>00317   out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#aae4bfab581619f524b69104a589634bb" title="Egress Outer VLAN or SD-TAG VLAN ID.">egress_vlan</a> = <a class="code" href="example__qos_8c.html#a5be88c338e62fa10f68b2344cc53b7d6">down_ovlan1</a>;
<a name="l00318"></a>00318   out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a> = port_out;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320   <a class="code" href="group__vlan.html#gaa1bf59398c66fd46c9109b4fc9d79051" title="Initialize the VLAN port structure.">opennsl_vlan_port_t_init</a>(&amp;in_vlan_port2);
<a name="l00321"></a>00321   in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#ab94d90776edeb955129f95b07f287181" title="Match criteria.">criteria</a> = <a class="code" href="group__vlan.html#ggac691cd787b4b6aa9a2f8b83659d4af50a0e8e71613acf7f6159c59d446e5bb1d0" title="Mod/port/trunk + outer VLAN.">OPENNSL_VLAN_PORT_MATCH_PORT_VLAN</a>;
<a name="l00322"></a>00322   in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a10ec33efb60f9917b243dd872dc3858f" title="Outer VLAN ID to match.">match_vlan</a> = <a class="code" href="example__qos_8c.html#a3dac63c8a5b5d1ccf667d0f7374ea64e">up_ovlan</a>;
<a name="l00323"></a>00323   in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#aae4bfab581619f524b69104a589634bb" title="Egress Outer VLAN or SD-TAG VLAN ID.">egress_vlan</a> = <a class="code" href="example__qos_8c.html#a3dac63c8a5b5d1ccf667d0f7374ea64e">up_ovlan</a>;
<a name="l00324"></a>00324   in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a> = port_in;
<a name="l00325"></a>00325   in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a7780aaa81891b515df40ae3696db218b" title="OPENNSL_VLAN_PORT_xxx.">flags</a> = (<a class="code" href="group__vlan.html#gacd3ff246480fbe6fe3623a5f315d187a" title="Preserve the outer VLAN tag (by default it is stripped).">OPENNSL_VLAN_PORT_OUTER_VLAN_PRESERVE</a> | <a class="code" href="group__vlan.html#ga2ca388882eeafa8c78514d8e00ba3a93" title="Preserve the inner VLAN tag (by default it is stripped).">OPENNSL_VLAN_PORT_INNER_VLAN_PRESERVE</a>);
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <a class="code" href="group__vlan.html#gaa1bf59398c66fd46c9109b4fc9d79051" title="Initialize the VLAN port structure.">opennsl_vlan_port_t_init</a>(&amp;out_vlan_port2);
<a name="l00328"></a>00328   out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#ab94d90776edeb955129f95b07f287181" title="Match criteria.">criteria</a> = <a class="code" href="group__vlan.html#ggac691cd787b4b6aa9a2f8b83659d4af50a0e8e71613acf7f6159c59d446e5bb1d0" title="Mod/port/trunk + outer VLAN.">OPENNSL_VLAN_PORT_MATCH_PORT_VLAN</a>;
<a name="l00329"></a>00329   out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a10ec33efb60f9917b243dd872dc3858f" title="Outer VLAN ID to match.">match_vlan</a> = <a class="code" href="example__qos_8c.html#aeea8641b678030d4ba20b5a9fc0ffef7">down_ovlan2</a>;
<a name="l00330"></a>00330   out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#aae4bfab581619f524b69104a589634bb" title="Egress Outer VLAN or SD-TAG VLAN ID.">egress_vlan</a> = <a class="code" href="example__qos_8c.html#aeea8641b678030d4ba20b5a9fc0ffef7">down_ovlan2</a>;
<a name="l00331"></a>00331   out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a38cc4cd1deb11194217fc3eed635b108" title="Gport: local or remote Physical or logical gport.">port</a> = port_out;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333   <span class="comment">/* set port VLAN domain */</span>
<a name="l00334"></a>00334   rv = <a class="code" href="group__port.html#gabe79179f76f375308b9a171f22905e32" title="Set or get port classification ID to aggregate a group of ports for further processing such as VLAN t...">opennsl_port_class_set</a>(unit, port_in, <a class="code" href="group__port.html#gga903dae8c0551492cc12715a9890175f3afd53eb54962612e34216b25545ae5fda" title="Class for mapping local-port to vlan-domain.">opennslPortClassId</a>, port_in);
<a name="l00335"></a>00335   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00336"></a>00336   {
<a name="l00337"></a>00337     printf(<span class="stringliteral">&quot;error in opennsl_port_class_set() $rv\n&quot;</span>);
<a name="l00338"></a>00338     <span class="keywordflow">return</span> rv;
<a name="l00339"></a>00339   }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341   rv = <a class="code" href="group__port.html#gabe79179f76f375308b9a171f22905e32" title="Set or get port classification ID to aggregate a group of ports for further processing such as VLAN t...">opennsl_port_class_set</a>(unit, port_out, <a class="code" href="group__port.html#gga903dae8c0551492cc12715a9890175f3afd53eb54962612e34216b25545ae5fda" title="Class for mapping local-port to vlan-domain.">opennslPortClassId</a>, port_out);
<a name="l00342"></a>00342   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00343"></a>00343   {
<a name="l00344"></a>00344     printf(<span class="stringliteral">&quot;error in opennsl_port_class_set() $rv\n&quot;</span>);
<a name="l00345"></a>00345     <span class="keywordflow">return</span> rv;
<a name="l00346"></a>00346   }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348   <span class="comment">/* create default egress qos profile */</span>
<a name="l00349"></a>00349   <a class="code" href="example__qos_8c.html#a82d05e2a85bb80929621fbb076d4487f">qos_map_l2_eg_dft_profile</a>(unit, <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>);
<a name="l00350"></a>00350   <a class="code" href="example__qos_8c.html#a82d05e2a85bb80929621fbb076d4487f">qos_map_l2_eg_dft_profile</a>(unit, <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352   <span class="keywordflow">return</span> rv;
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="comment">/*</span>
<a name="l00357"></a>00357 <span class="comment">* Set up tagged and untagged sercies, using port cross connect. </span>
<a name="l00358"></a>00358 <span class="comment">*/</span> 
<a name="l00359"></a><a class="code" href="example__qos_8c.html#a4f29952cd8470136b30a4e23338cdf72">00359</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#a4f29952cd8470136b30a4e23338cdf72">initial_qos_service</a>(<span class="keywordtype">int</span> unit)
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00362"></a>00362   <a class="code" href="group__types.html#ga238c767c6c5b6a0a47dd9d1504936cf0" title="GPORT (generic port) definitions.">opennsl_gport_t</a> in_gport1, in_gport2, out_gport1, out_gport2;
<a name="l00363"></a>00363   in_gport1 = 0;
<a name="l00364"></a>00364   in_gport2 = 0;
<a name="l00365"></a>00365   out_gport1 = 0;    
<a name="l00366"></a>00366   out_gport2 = 0;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368   <span class="comment">/* create inLIF for untagged service */</span>
<a name="l00369"></a>00369   rv = <a class="code" href="group__vlan.html#ga019a29bf98cbf78d0b609f3e1b00d473" title="Create a layer 2 logical port.">opennsl_vlan_port_create</a>(unit, &amp;in_vlan_port1);
<a name="l00370"></a>00370   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00371"></a>00371   {
<a name="l00372"></a>00372     printf(<span class="stringliteral">&quot;lif_create failed! %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00373"></a>00373     <span class="keywordflow">return</span> rv;
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375   in_gport1 = in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00376"></a>00376   printf(<span class="stringliteral">&quot;%d\n&quot;</span>, in_gport1);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378   <span class="comment">/* create inLIF for tagged service */</span>
<a name="l00379"></a>00379   rv = <a class="code" href="group__vlan.html#ga019a29bf98cbf78d0b609f3e1b00d473" title="Create a layer 2 logical port.">opennsl_vlan_port_create</a>(unit, &amp;in_vlan_port2);
<a name="l00380"></a>00380   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00381"></a>00381   {
<a name="l00382"></a>00382     printf(<span class="stringliteral">&quot;lif_create failed! %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00383"></a>00383     <span class="keywordflow">return</span> rv;
<a name="l00384"></a>00384   }
<a name="l00385"></a>00385   in_gport2 = in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00386"></a>00386   printf(<span class="stringliteral">&quot;%d\n&quot;</span>, in_gport2);
<a name="l00387"></a>00387 
<a name="l00388"></a>00388   <span class="comment">/* create outLIF for untagged service */</span>
<a name="l00389"></a>00389   rv = <a class="code" href="group__vlan.html#ga019a29bf98cbf78d0b609f3e1b00d473" title="Create a layer 2 logical port.">opennsl_vlan_port_create</a>(unit, &amp;out_vlan_port1);
<a name="l00390"></a>00390   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00391"></a>00391   {
<a name="l00392"></a>00392     printf(<span class="stringliteral">&quot;lif_create failed! %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00393"></a>00393     <span class="keywordflow">return</span> rv;
<a name="l00394"></a>00394   }
<a name="l00395"></a>00395   out_gport1 = out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00396"></a>00396   printf(<span class="stringliteral">&quot;%d\n&quot;</span>, out_gport1);
<a name="l00397"></a>00397 
<a name="l00398"></a>00398   <span class="comment">/* create outLIF for tagged service */</span>
<a name="l00399"></a>00399   rv = <a class="code" href="group__vlan.html#ga019a29bf98cbf78d0b609f3e1b00d473" title="Create a layer 2 logical port.">opennsl_vlan_port_create</a>(unit, &amp;out_vlan_port2);
<a name="l00400"></a>00400   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00401"></a>00401   {
<a name="l00402"></a>00402     printf(<span class="stringliteral">&quot;lif_create failed! %s\n&quot;</span>, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00403"></a>00403     <span class="keywordflow">return</span> rv;
<a name="l00404"></a>00404   }
<a name="l00405"></a>00405   out_gport2 = out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00406"></a>00406   printf(<span class="stringliteral">&quot;%d\n&quot;</span>, out_gport2);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <span class="comment">/* add eve action for untagged service */</span>
<a name="l00409"></a>00409   <a class="code" href="example__qos_8c.html#a2d4531e9c41943ae8e6268c4490291be">initial_qos_service_vlan_action_set</a>(unit, <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>);
<a name="l00410"></a>00410   <a class="code" href="group__vswitch.html#ga340a3960bb4b9618ae5d861e4dd44e0f">opennsl_vswitch_cross_connect_t_init</a>(&amp;gports_untag);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   gports_untag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#aaba79634bfeef5834696a373bb28799c" title="First gport in cross connect.">port1</a> = in_gport1;
<a name="l00413"></a>00413   gports_untag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#af243f2074c916a95c5bb10b3d6590822" title="Second gport in cross connect.">port2</a> = out_gport1;
<a name="l00414"></a>00414 
<a name="l00415"></a>00415   <span class="comment">/* cross connect two lifs for untagged service */</span>
<a name="l00416"></a>00416   rv = <a class="code" href="group__vswitch.html#ga96551b13c0e1eec1550c2711058d9549" title="Attach two given logical ports in a point-to-point service.">opennsl_vswitch_cross_connect_add</a>(unit, &amp;gports_untag);
<a name="l00417"></a>00417   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00418"></a>00418   {
<a name="l00419"></a>00419     printf(<span class="stringliteral">&quot;error in opennsl_vswitch_cross_connect_add() $rv\n&quot;</span>);
<a name="l00420"></a>00420     <span class="keywordflow">return</span> rv;
<a name="l00421"></a>00421   }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423   <span class="comment">/* add eve action for tagged service */</span>
<a name="l00424"></a>00424   <a class="code" href="example__qos_8c.html#a2d4531e9c41943ae8e6268c4490291be">initial_qos_service_vlan_action_set</a>(unit, <a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>);
<a name="l00425"></a>00425 
<a name="l00426"></a>00426   <a class="code" href="group__vswitch.html#ga340a3960bb4b9618ae5d861e4dd44e0f">opennsl_vswitch_cross_connect_t_init</a>(&amp;gports_tag);
<a name="l00427"></a>00427   gports_tag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#aaba79634bfeef5834696a373bb28799c" title="First gport in cross connect.">port1</a> = in_gport2;
<a name="l00428"></a>00428   gports_tag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#af243f2074c916a95c5bb10b3d6590822" title="Second gport in cross connect.">port2</a> = out_gport2;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430   <span class="comment">/* cross connect two lifs for tagged service */</span>
<a name="l00431"></a>00431   rv = <a class="code" href="group__vswitch.html#ga96551b13c0e1eec1550c2711058d9549" title="Attach two given logical ports in a point-to-point service.">opennsl_vswitch_cross_connect_add</a>(unit, &amp;gports_tag);
<a name="l00432"></a>00432   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00433"></a>00433   {
<a name="l00434"></a>00434     printf(<span class="stringliteral">&quot;error in opennsl_vswitch_cross_connect_add() $rv\n&quot;</span>);
<a name="l00435"></a>00435   }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keywordflow">return</span> rv;
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 <span class="comment">/*</span>
<a name="l00442"></a>00442 <span class="comment">* clean tagged and untagged sercies </span>
<a name="l00443"></a>00443 <span class="comment">*/</span>
<a name="l00444"></a><a class="code" href="example__qos_8c.html#ad19f0c25a5eb037661f6b66c58c82fbc">00444</a> <span class="keywordtype">int</span> <a class="code" href="example__qos_8c.html#ad19f0c25a5eb037661f6b66c58c82fbc">initial_qos_service_cleanup</a>(<span class="keywordtype">int</span> unit)
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446   <span class="keywordtype">int</span> rv = <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 
<a name="l00449"></a>00449   gports_untag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#aaba79634bfeef5834696a373bb28799c" title="First gport in cross connect.">port1</a> = in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00450"></a>00450   gports_untag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#af243f2074c916a95c5bb10b3d6590822" title="Second gport in cross connect.">port2</a> = out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00451"></a>00451   gports_tag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#aaba79634bfeef5834696a373bb28799c" title="First gport in cross connect.">port1</a> = in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00452"></a>00452   gports_tag.<a class="code" href="structopennsl__vswitch__cross__connect__s.html#af243f2074c916a95c5bb10b3d6590822" title="Second gport in cross connect.">port2</a> = out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454   <span class="comment">/* Delete the cross connected LIFs for untagged service */</span>
<a name="l00455"></a>00455   rv = <a class="code" href="group__vswitch.html#gac7f6918f99f69f696f370d0550bb6790" title="Remove attachment between the given logical ports.">opennsl_vswitch_cross_connect_delete</a>(unit, &amp;gports_untag);
<a name="l00456"></a>00456   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00457"></a>00457   {
<a name="l00458"></a>00458     printf(<span class="stringliteral">&quot;Error, opennsl_vswitch_cross_connect_delete() $rv\n&quot;</span>);
<a name="l00459"></a>00459     <span class="keywordflow">return</span> rv;
<a name="l00460"></a>00460   }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462   <span class="comment">/* Delete the cross connected LIFs for tagged service */</span>
<a name="l00463"></a>00463   rv = <a class="code" href="group__vswitch.html#gac7f6918f99f69f696f370d0550bb6790" title="Remove attachment between the given logical ports.">opennsl_vswitch_cross_connect_delete</a>(unit, &amp;gports_tag);
<a name="l00464"></a>00464   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00465"></a>00465   {
<a name="l00466"></a>00466     printf(<span class="stringliteral">&quot;Error, opennsl_vswitch_cross_connect_delete() $rv\n&quot;</span>);
<a name="l00467"></a>00467     <span class="keywordflow">return</span> rv;
<a name="l00468"></a>00468   }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470   <span class="comment">/* Delete inLIF for untagged service */</span>
<a name="l00471"></a>00471   rv = <a class="code" href="group__vlan.html#gae4efeb6b6831a2640284bb31a07bb832" title="Destroy a layer 2 logical port.">opennsl_vlan_port_destroy</a>(unit, in_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>);
<a name="l00472"></a>00472   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00473"></a>00473   {
<a name="l00474"></a>00474     printf(<span class="stringliteral">&quot;Error, opennsl_vlan_port_destroy() $rv\n&quot;</span>);
<a name="l00475"></a>00475     <span class="keywordflow">return</span> rv;
<a name="l00476"></a>00476   }
<a name="l00477"></a>00477 
<a name="l00478"></a>00478   <span class="comment">/* Delete outLIF for untagged service */</span>
<a name="l00479"></a>00479   rv = <a class="code" href="group__vlan.html#gae4efeb6b6831a2640284bb31a07bb832" title="Destroy a layer 2 logical port.">opennsl_vlan_port_destroy</a>(unit, out_vlan_port1.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>);
<a name="l00480"></a>00480   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00481"></a>00481   {
<a name="l00482"></a>00482     printf(<span class="stringliteral">&quot;Error, opennsl_vlan_port_destroy() $rv\n&quot;</span>);
<a name="l00483"></a>00483     <span class="keywordflow">return</span> rv;
<a name="l00484"></a>00484   }
<a name="l00485"></a>00485 
<a name="l00486"></a>00486   <span class="comment">/* Delete inLIF for tagged service */</span>
<a name="l00487"></a>00487   rv = <a class="code" href="group__vlan.html#gae4efeb6b6831a2640284bb31a07bb832" title="Destroy a layer 2 logical port.">opennsl_vlan_port_destroy</a>(unit, in_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>);
<a name="l00488"></a>00488   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00489"></a>00489   {
<a name="l00490"></a>00490     printf(<span class="stringliteral">&quot;Error, opennsl_vlan_port_destroy() $rv\n&quot;</span>);
<a name="l00491"></a>00491     <span class="keywordflow">return</span> rv;
<a name="l00492"></a>00492   }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494   <span class="comment">/* Delete outLIF for tagged service*/</span>
<a name="l00495"></a>00495   rv = <a class="code" href="group__vlan.html#gae4efeb6b6831a2640284bb31a07bb832" title="Destroy a layer 2 logical port.">opennsl_vlan_port_destroy</a>(unit, out_vlan_port2.<a class="code" href="structopennsl__vlan__port__s.html#a6bf4ca3edeb7068c9baea003faad1f52" title="GPORT identifier.">vlan_port_id</a>);
<a name="l00496"></a>00496   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00497"></a>00497   {
<a name="l00498"></a>00498     printf(<span class="stringliteral">&quot;Error, opennsl_vlan_port_destroy() $rv\n&quot;</span>);
<a name="l00499"></a>00499     <span class="keywordflow">return</span> rv;
<a name="l00500"></a>00500   }
<a name="l00501"></a>00501 
<a name="l00502"></a>00502   <span class="comment">/* destroy the qos profile */</span>
<a name="l00503"></a>00503   <a class="code" href="group__qos.html#ga413e488c7b88957e32e572ef110f0d71" title="Frees hardware resources for QoS mapping.">opennsl_qos_map_destroy</a>(unit, <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[<a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72aa4aff4db03ef735c22eda0d745ec1336">match_untag</a>]);
<a name="l00504"></a>00504   <a class="code" href="group__qos.html#ga413e488c7b88957e32e572ef110f0d71" title="Frees hardware resources for QoS mapping.">opennsl_qos_map_destroy</a>(unit, <a class="code" href="example__qos_8c.html#aa44e37fccfd9234fdeebc48c560cfece">qos_eg_map_id_dft</a>[<a class="code" href="example__qos_8c.html#a530725d62a88974caaa9b1c91080db72ac6b810c26f58e843de1254750b6840b8">match_otag</a>]);
<a name="l00505"></a>00505 
<a name="l00506"></a>00506   <span class="keywordflow">return</span> rv;        
<a name="l00507"></a>00507 }
<a name="l00508"></a>00508 <span class="comment">/* __doxy_func_body_end__ */</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 <span class="comment">/*****************************************************************/</span>
<a name="l00518"></a><a class="code" href="example__qos_8c.html#a0ddf1224851353fc92bfbff6f499fa97">00518</a> <span class="keywordtype">int</span> <a class="code" href="example__cos_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main function for policer application.">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
<a name="l00519"></a>00519 {
<a name="l00520"></a>00520   <span class="keywordtype">int</span> rv = 0;
<a name="l00521"></a>00521   <span class="keywordtype">int</span> unit = <a class="code" href="example__qos_8c.html#adbb76aecfc5eef000cb4cb55bc2fd404">DEFAULT_UNIT</a>;
<a name="l00522"></a>00522   <span class="keywordtype">int</span> choice;
<a name="l00523"></a>00523   <span class="keywordtype">int</span> inport, outport, use_de;
<a name="l00524"></a>00524 
<a name="l00525"></a>00525   <span class="keywordflow">if</span>((argc != 1) || ((argc &gt; 1) &amp;&amp; (strcmp(argv[1], <span class="stringliteral">&quot;--help&quot;</span>) == 0))) 
<a name="l00526"></a>00526   {
<a name="l00527"></a>00527     printf(<span class="stringliteral">&quot;%s\n\r&quot;</span>, <a class="code" href="example__cos_8c.html#afc7d01e6dbea2c820a68fb8081c58a89">example_usage</a>);
<a name="l00528"></a>00528     <span class="keywordflow">return</span> <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a8b380efdb47b4a4b0ebafbb1c7823748">OPENNSL_E_PARAM</a>;
<a name="l00529"></a>00529   }
<a name="l00530"></a>00530 
<a name="l00531"></a>00531   <span class="comment">/* Initialize the system. */</span>
<a name="l00532"></a>00532   rv = <a class="code" href="driver_8h.html#a06a6fe41f5ea8664c461423d3cad0923" title="Function to initialize the switch.">opennsl_driver_init</a>((<a class="code" href="structopennsl__config__s.html">opennsl_init_t</a> *) <a class="code" href="sal_2types_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);
<a name="l00533"></a>00533   <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00534"></a>00534   {
<a name="l00535"></a>00535     printf(<span class="stringliteral">&quot;\r\nFailed to initialize the system. Error: %s\r\n&quot;</span>,
<a name="l00536"></a>00536            <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00537"></a>00537     <span class="keywordflow">return</span> rv;
<a name="l00538"></a>00538   }
<a name="l00539"></a>00539 
<a name="l00540"></a>00540   <span class="comment">/* cold boot initialization commands */</span>
<a name="l00541"></a>00541   rv = <a class="code" href="examples_2util_8h.html#a2846e8ec8f46d212a3ae2493bdff7980" title="Set default configuration (like STP state, speed/duplex) for all ports.">example_port_default_config</a>(unit);
<a name="l00542"></a>00542   <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00543"></a>00543   {
<a name="l00544"></a>00544     printf(<span class="stringliteral">&quot;\r\nFailed to apply default config on ports, rc = %d (%s).\r\n&quot;</span>,
<a name="l00545"></a>00545            rv, <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00546"></a>00546   }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548   <span class="comment">/* Add ports to default vlan. */</span>
<a name="l00549"></a>00549   printf(<span class="stringliteral">&quot;Adding ports to default vlan.\r\n&quot;</span>);
<a name="l00550"></a>00550   rv = <a class="code" href="examples_2util_8h.html#a2d14e4de1f4a7192ac7e378f8f7c63ff" title="Add all ports to default vlan.">example_switch_default_vlan_config</a>(unit);
<a name="l00551"></a>00551   <span class="keywordflow">if</span>(rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00552"></a>00552   {
<a name="l00553"></a>00553     printf(<span class="stringliteral">&quot;\r\nFailed to add default ports. Error: %s\r\n&quot;</span>,
<a name="l00554"></a>00554         <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00555"></a>00555 
<a name="l00556"></a>00556     <span class="keywordflow">return</span> rv;
<a name="l00557"></a>00557   }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559   <span class="keywordflow">while</span>(1) {
<a name="l00560"></a>00560     printf(<span class="stringliteral">&quot;\r\nUser menu: Select one of the following options\r\n&quot;</span>);
<a name="l00561"></a>00561     printf(<span class="stringliteral">&quot;1. Create QoS mapping\n&quot;</span>);
<a name="l00562"></a>00562 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00563"></a>00563 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;9. Launch diagnostic shell\n&quot;</span>);
<a name="l00564"></a>00564 <span class="preprocessor">#endif</span>
<a name="l00565"></a>00565 <span class="preprocessor"></span>    printf(<span class="stringliteral">&quot;0. Quit the application.\r\n&quot;</span>);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567     <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;choice) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00568"></a>00568     {
<a name="l00569"></a>00569       printf(<span class="stringliteral">&quot;Invalid option entered. Please re-enter.\n&quot;</span>);
<a name="l00570"></a>00570       <span class="keywordflow">continue</span>;
<a name="l00571"></a>00571     }
<a name="l00572"></a>00572     <span class="keywordflow">switch</span>(choice)
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574       <span class="keywordflow">case</span> 1:
<a name="l00575"></a>00575       {
<a name="l00576"></a>00576         printf(<span class="stringliteral">&quot;Enter the input port number(belonging to core-0):\n&quot;</span>);
<a name="l00577"></a>00577         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;inport) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00578"></a>00578         {
<a name="l00579"></a>00579           printf(<span class="stringliteral">&quot;Invalid value entered. Please re-enter.\n&quot;</span>);
<a name="l00580"></a>00580           <span class="keywordflow">continue</span>;
<a name="l00581"></a>00581         }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583         printf(<span class="stringliteral">&quot;Enter the output port number(belonging to core-0):\n&quot;</span>);
<a name="l00584"></a>00584         <span class="keywordflow">if</span>(<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;outport) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>)
<a name="l00585"></a>00585         {
<a name="l00586"></a>00586           printf(<span class="stringliteral">&quot;Invalid value entered. Please re-enter.\n&quot;</span>);
<a name="l00587"></a>00587           <span class="keywordflow">continue</span>;
<a name="l00588"></a>00588         }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590         printf(<span class="stringliteral">&quot;Enter whether to use DEI for QoS mapping(0/1):\n&quot;</span>);
<a name="l00591"></a>00591         <span class="keywordflow">if</span>((<a class="code" href="examples_2util_8h.html#ad0173c952d5a8af01c14eebabc05b5df" title="Read numeric menu choice from user.">example_read_user_choice</a>(&amp;use_de) != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) ||
<a name="l00592"></a>00592            ((use_de != 0) &amp;&amp; (use_de != 1)))
<a name="l00593"></a>00593         {
<a name="l00594"></a>00594           printf(<span class="stringliteral">&quot;Invalid value entered. Please re-enter.\n&quot;</span>);
<a name="l00595"></a>00595           <span class="keywordflow">continue</span>;
<a name="l00596"></a>00596         }
<a name="l00597"></a>00597 
<a name="l00598"></a>00598         rv = <a class="code" href="example__qos_8c.html#addcb57c9ee65d18f93545a731cd409c6">initial_qos_service_init</a>(unit, inport, outport); 
<a name="l00599"></a>00599         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00600"></a>00600         {
<a name="l00601"></a>00601           printf(<span class="stringliteral">&quot;\r\nFailed to initialize the QoS service. Error: %s\r\n&quot;</span>,
<a name="l00602"></a>00602              <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00603"></a>00603           <span class="keywordflow">break</span>;
<a name="l00604"></a>00604   }  
<a name="l00605"></a>00605 
<a name="l00606"></a>00606         rv = <a class="code" href="example__qos_8c.html#a4f29952cd8470136b30a4e23338cdf72">initial_qos_service</a>(unit); 
<a name="l00607"></a>00607         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00608"></a>00608         {
<a name="l00609"></a>00609           printf(<span class="stringliteral">&quot;\r\nFailed to start the initial QoS service. Error: %s\r\n&quot;</span>,
<a name="l00610"></a>00610               <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00611"></a>00611           <span class="keywordflow">break</span>;
<a name="l00612"></a>00612         }  
<a name="l00613"></a>00613 
<a name="l00614"></a>00614         rv = <a class="code" href="example__qos_8c.html#ae31c8867a38c33e793aff85a3c8a7627">qos_pcp_map_create</a>(unit, inport, use_de);
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (rv != <a class="code" href="group__error.html#ggab4c007d9d8465756b8f672c33764e6d5a549cc71e16fe086c0311d03bc995a11b">OPENNSL_E_NONE</a>) 
<a name="l00616"></a>00616         {
<a name="l00617"></a>00617           printf(<span class="stringliteral">&quot;\r\nFailed to create the QoS PCP mapping. Error: %s\r\n&quot;</span>,
<a name="l00618"></a>00618               <a class="code" href="group__error.html#ga6d47e9cb22df965b977f3810bdc0ce3e">opennsl_errmsg</a>(rv));
<a name="l00619"></a>00619         }  
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         <span class="keywordflow">break</span>;
<a name="l00622"></a>00622       }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 <span class="preprocessor">#ifdef INCLUDE_DIAG_SHELL</span>
<a name="l00625"></a>00625 <span class="preprocessor"></span>      <span class="keywordflow">case</span> 9:
<a name="l00626"></a>00626       {
<a name="l00627"></a>00627         opennsl_driver_shell();
<a name="l00628"></a>00628         <span class="keywordflow">break</span>;
<a name="l00629"></a>00629       }
<a name="l00630"></a>00630 <span class="preprocessor">#endif</span>
<a name="l00631"></a>00631 <span class="preprocessor"></span>
<a name="l00632"></a>00632       <span class="keywordflow">case</span> 0:
<a name="l00633"></a>00633       {
<a name="l00634"></a>00634         printf(<span class="stringliteral">&quot;Exiting the application.\n&quot;</span>);
<a name="l00635"></a>00635         rv = <a class="code" href="driver_8h.html#aa760e8f1af45c7fd27ec014b82c572f2" title="Function to free up the resources and exit the driver.">opennsl_driver_exit</a>();
<a name="l00636"></a>00636         <span class="keywordflow">return</span> rv;
<a name="l00637"></a>00637       }
<a name="l00638"></a>00638       <span class="keywordflow">default</span>:
<a name="l00639"></a>00639       <span class="keywordflow">break</span>;
<a name="l00640"></a>00640     } <span class="comment">/* End of switch */</span>
<a name="l00641"></a>00641   } <span class="comment">/* End of while */</span>
<a name="l00642"></a>00642 
<a name="l00643"></a>00643   <span class="keywordflow">return</span> rv;
<a name="l00644"></a>00644 }
<a name="l00645"></a>00645 <span class="comment">/* __doxy_func_body_end__ */</span>
</pre></div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->


<!--BEGIN GENERATE_TREEVIEW -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->

<hr>
<p>	
<table class="footer-brcm">
	<tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align=left></td>
		<td class="footer-brcm"><small><b>&copy;  2016-17 by Broadcom Limited. All rights reserved.</b></small>
			<div class="footer-brcm"><small>Broadcom Limited reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design. 
Information furnished by Broadcom Limited is believed to be accurate and reliable. However, Broadcom Limited does not assume any liability arising 
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license 
under its patent rights nor the rights of others. </small>
			</div>
		</td>
	</tr>
</table>	
</p>	
	

</div>

<!--END GENERATE_TREEVIEW-->





</body>
</html>
